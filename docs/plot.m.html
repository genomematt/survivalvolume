<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>plot API documentation</title>
    <meta name="description" content="survivalvolume/plot.py

Functions and classes for plotting tumour volume vs time and survival endpoi..." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#plot.get_survival_status">get_survival_status</a></li>
    <li class="mono"><a href="#plot.make_km">make_km</a></li>
    <li class="mono"><a href="#plot.version">version</a></li>
    <li class="mono"><a href="#plot.volume_to_survival">volume_to_survival</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#plot.HighlightLines">HighlightLines</a></span>
        
          
  <ul>
    <li class="mono"><a href="#plot.HighlightLines.__init__">__init__</a></li>
    <li class="mono"><a href="#plot.HighlightLines.css">css</a></li>
    <li class="mono"><a href="#plot.HighlightLines.get_dict">get_dict</a></li>
    <li class="mono"><a href="#plot.HighlightLines.javascript">javascript</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#plot.TumourVolumePlot">TumourVolumePlot</a></span>
        
          
  <ul>
    <li class="mono"><a href="#plot.TumourVolumePlot.__init__">__init__</a></li>
    <li class="mono"><a href="#plot.TumourVolumePlot.add_individuals">add_individuals</a></li>
    <li class="mono"><a href="#plot.TumourVolumePlot.add_interval">add_interval</a></li>
    <li class="mono"><a href="#plot.TumourVolumePlot.add_legend">add_legend</a></li>
    <li class="mono"><a href="#plot.TumourVolumePlot.add_mean">add_mean</a></li>
    <li class="mono"><a href="#plot.TumourVolumePlot.display">display</a></li>
    <li class="mono"><a href="#plot.TumourVolumePlot.remove_legend">remove_legend</a></li>
    <li class="mono"><a href="#plot.TumourVolumePlot.save_html">save_html</a></li>
    <li class="mono"><a href="#plot.TumourVolumePlot.save_pdf">save_pdf</a></li>
    <li class="mono"><a href="#plot.TumourVolumePlot.set_limits">set_limits</a></li>
    <li class="mono"><a href="#plot.TumourVolumePlot.set_spines_and_ticks">set_spines_and_ticks</a></li>
    <li class="mono"><a href="#plot.TumourVolumePlot.set_title_and_labels">set_title_and_labels</a></li>
    <li class="mono"><a href="#plot.TumourVolumePlot.shade_interval">shade_interval</a></li>
    <li class="mono"><a href="#plot.TumourVolumePlot.show_treatment_days">show_treatment_days</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#plot.VolumeSurvivalPlot">VolumeSurvivalPlot</a></span>
        
          
  <ul>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.__init__">__init__</a></li>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.add_individuals">add_individuals</a></li>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.add_interval">add_interval</a></li>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.add_kmf">add_kmf</a></li>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.add_legend">add_legend</a></li>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.add_mean">add_mean</a></li>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.display">display</a></li>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.logrank_test">logrank_test</a></li>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.remove_legend">remove_legend</a></li>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.save_html">save_html</a></li>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.save_pdf">save_pdf</a></li>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.set_limits">set_limits</a></li>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.set_spines_and_ticks">set_spines_and_ticks</a></li>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.set_title_and_labels">set_title_and_labels</a></li>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.shade_interval">shade_interval</a></li>
    <li class="mono"><a href="#plot.VolumeSurvivalPlot.show_treatment_days">show_treatment_days</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">plot</span> module</h1>
  <p>survivalvolume/plot.py</p>
<p>Functions and classes for plotting tumour volume vs time and survival endpoints based on volume thresholds</p>
<p>Created by Matthew Wakefield.
Copyright (c) 2016  Matthew Wakefield, The Walter and Eliza Hall Institute and The University of Melbourne. All rights reserved.</p>
<p>This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot', this);">Show source &equiv;</a></p>
  <div id="source-plot" class="source">
    <div class="codehilite"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># encoding: utf-8</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">survivalvolume/plot.py</span>

<span class="sd">Functions and classes for plotting tumour volume vs time and survival endpoints based on volume thresholds</span>

<span class="sd">Created by Matthew Wakefield.</span>
<span class="sd">Copyright (c) 2016  Matthew Wakefield, The Walter and Eliza Hall Institute and The University of Melbourne. All rights reserved.</span>

<span class="sd">   </span>
<span class="sd">   This program is distributed in the hope that it will be useful,</span>
<span class="sd">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>


<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">mpld3</span>
<span class="kn">import</span> <span class="nn">lifelines</span>
<span class="kn">from</span> <span class="nn">lifelines.statistics</span> <span class="kn">import</span> <span class="n">logrank_test</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="kn">from</span> <span class="nn">mpld3</span> <span class="kn">import</span> <span class="n">plugins</span><span class="p">,</span> <span class="n">utils</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Matthew Wakefield&quot;</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s2">&quot;Copyright 2016 Matthew Wakefield, The Walter and Eliza Hall Institute and The University of Melbourne&quot;</span>
<span class="n">__credits__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Matthew Wakefield&quot;</span><span class="p">,]</span>
<span class="n">__license__</span> <span class="o">=</span> <span class="s2">&quot;GPLv3&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;1.2.0&quot;</span>
<span class="n">__maintainer__</span> <span class="o">=</span> <span class="s2">&quot;Matthew Wakefield&quot;</span>
<span class="n">__email__</span> <span class="o">=</span> <span class="s2">&quot;wakefield@wehi.edu.au&quot;</span>
<span class="n">__status__</span> <span class="o">=</span> <span class="s2">&quot;production&quot;</span>

<span class="k">def</span> <span class="nf">version</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Return the symatic versioning format version number&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">__version__</span>
    
<span class="k">def</span> <span class="nf">get_survival_status</span><span class="p">(</span><span class="n">tv_series</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="mi">700</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a pandas series of tumour volume measurements</span>
<span class="sd">    organised with one individual per column and indexed by time</span>
<span class="sd">    to a pandas data frame with columns for time and endpoint observed</span>
<span class="sd">    (the inverse of censored) and indexed by individual.</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        tv_series - a pandas series of tumour volume measurements</span>
<span class="sd">                    indexed by time</span>
<span class="sd">    </span>
<span class="sd">        endpoint  - the volume threshold at which and endpoint</span>
<span class="sd">                    event is deemed to have occurred</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    </span>
<span class="sd">        time      - the last time index observed</span>
<span class="sd">    </span>
<span class="sd">        observed  - a boolean for whether the endpoint has</span>
<span class="sd">                    been reached (inverse of censored status)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tv_series</span> <span class="o">=</span> <span class="n">tv_series</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">observed</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tv_series</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">endpoint</span><span class="p">:</span>
            <span class="n">observed</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="n">tv_series</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">observed</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">tv_series</span><span class="p">)</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">volume_to_survival</span><span class="p">(</span><span class="n">tv_data</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="mi">700</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a pandas data frame of tumour volume measurements</span>
<span class="sd">    organised with one individual per column and indexed by time</span>
<span class="sd">    to a pandas data frame with columns for time and endpoint observed</span>
<span class="sd">    (the inverse of censored) and indexed by individual.</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        tv_data   - a pandas data frame of volume measurements</span>
<span class="sd">                    arranged with individuals in columns and</span>
<span class="sd">                    indexed by time</span>
<span class="sd">    </span>
<span class="sd">        endpoint  - the volume threshold at which and endpoint</span>
<span class="sd">                    event is deemed to have occurred</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    </span>
<span class="sd">        A pandas data frame with columns &#39;Time&#39; and &#39;Observed&#39;</span>
<span class="sd">        indexed by individuals (column names in tv_data)</span>
<span class="sd">        Time      - the last time index observed</span>
<span class="sd">        Observed  - a boolean for whether the endpoint has</span>
<span class="sd">                    been reached (inverse of censored status)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">survival</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                        <span class="p">{</span><span class="n">x</span><span class="p">:</span><span class="n">get_survival_status</span><span class="p">(</span><span class="n">tv_data</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">)</span> \
                        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tv_data</span> <span class="k">if</span> <span class="n">tv_data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">any</span><span class="p">()}</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">survival</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="s1">&#39;Observed&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">survival</span>

<span class="k">def</span> <span class="nf">make_km</span><span class="p">(</span><span class="n">tv_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span><span class="n">endpoint</span><span class="o">=</span><span class="mi">700</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Construct a Kaplan-Meier function for a dataframe</span>
<span class="sd">    of tumour volume measurements</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        tv_data  - a pandas data frame of volume measurements</span>
<span class="sd">                   with individuals in columns and timepoints</span>
<span class="sd">                   as rows.  Individuals are removed from study</span>
<span class="sd">                   at the first NaN timepoint</span>
<span class="sd">    </span>
<span class="sd">        label    - a title for this grouping</span>
<span class="sd">    </span>
<span class="sd">        endpoint - the volume at which the endpoint is reached</span>
<span class="sd">                   Default: 700</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    </span>
<span class="sd">        a lifelines KaplanMeierFitter object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">survival</span> <span class="o">=</span> <span class="n">volume_to_survival</span><span class="p">(</span><span class="n">tv_data</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">)</span>
    <span class="n">kmf</span> <span class="o">=</span> <span class="n">lifelines</span><span class="o">.</span><span class="n">KaplanMeierFitter</span><span class="p">()</span>
    <span class="n">kmf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">survival</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">event_observed</span><span class="o">=</span><span class="n">survival</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kmf</span>

<span class="k">class</span> <span class="nc">HighlightLines</span><span class="p">(</span><span class="n">plugins</span><span class="o">.</span><span class="n">PluginBase</span><span class="p">):</span> <span class="c1">#pragma non cover</span>
    <span class="sd">&quot;&quot;&quot;A plugin to highlight lines on hover</span>
<span class="sd">    Adapted from mpld3 example code&quot;&quot;&quot;</span>

    <span class="n">JAVASCRIPT</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    mpld3.register_plugin(&quot;linehighlight&quot;, LineHighlightPlugin);</span>
<span class="s2">    LineHighlightPlugin.prototype = Object.create(mpld3.Plugin.prototype);</span>
<span class="s2">    LineHighlightPlugin.prototype.constructor = LineHighlightPlugin;</span>
<span class="s2">    LineHighlightPlugin.prototype.requiredProps = [&quot;line_ids&quot;];</span>
<span class="s2">    LineHighlightPlugin.prototype.defaultProps = {alpha_bg:0.3, alpha_fg:1.0}</span>
<span class="s2">    function LineHighlightPlugin(fig, props){</span>
<span class="s2">        mpld3.Plugin.call(this, fig, props);</span>
<span class="s2">    };</span>

<span class="s2">    LineHighlightPlugin.prototype.draw = function(){</span>
<span class="s2">      for(var i=0; i&lt;this.props.line_ids.length; i++){</span>
<span class="s2">         var obj = mpld3.get_element(this.props.line_ids[i], this.fig),</span>
<span class="s2">             alpha_fg = this.props.alpha_fg;</span>
<span class="s2">             alpha_bg = this.props.alpha_bg;</span>
<span class="s2">         obj.elements()</span>
<span class="s2">             .on(&quot;mouseover.highlight&quot;, function(d, i){</span>
<span class="s2">                            d3.select(this).transition().duration(50)</span>
<span class="s2">                              .style(&quot;stroke-opacity&quot;, alpha_fg); })</span>
<span class="s2">             .on(&quot;mouseout.highlight&quot;, function(d, i){</span>
<span class="s2">                            d3.select(this).transition().duration(200)</span>
<span class="s2">                              .style(&quot;stroke-opacity&quot;, alpha_bg); });</span>
<span class="s2">      }</span>
<span class="s2">    };</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;linehighlight&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;line_ids&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">utils</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">],</span>
                      <span class="s2">&quot;alpha_bg&quot;</span><span class="p">:</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_alpha</span><span class="p">(),</span>
                      <span class="s2">&quot;alpha_fg&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>

<span class="k">class</span> <span class="nc">TumourVolumePlot</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Construct a plot of volume vs time</span>
<span class="sd">    This plot is designed to consist of measurements for individuals,</span>
<span class="sd">    a mean volume for the group and a standard error of the mean.</span>
<span class="sd">    When used to produce html the resulting graph is interactive with</span>
<span class="sd">    mouse over highlighting of individuals and labeling with the column</span>
<span class="sd">    name.  Static pdfs can also be generated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initiate a new tumour TumourVolumePlot object</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            **kw - keyword arguments are passed to</span>
<span class="sd">                   matplotlib.pyplot.subplots</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">means</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intervals</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Untitled&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;Tumour Volume mm$^{3}$&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Days&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">remove_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove any existing matplotlib axis legend&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">set_spines_and_ticks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                            <span class="n">remove_spines</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="s1">&#39;top&#39;</span><span class="p">],</span>
                            <span class="n">y_set_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span>
                            <span class="n">x_set_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">],</span>
                            <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set spines (the lines along the axis) and</span>
<span class="sd">        tick locations for the plot</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">            </span>
<span class="sd">            axes - the matplotlib.axis object to act on</span>
<span class="sd">                   Default: None (interpreted as self.ax)</span>
<span class="sd">            </span>
<span class="sd">            remove_spines - a list of spines to remove.</span>
<span class="sd">                   Default: [&#39;right&#39;,&#39;top&#39;]</span>
<span class="sd">            </span>
<span class="sd">            y_set_ticks - a list of locations of y axis ticks</span>
<span class="sd">                   Default: [&#39;left&#39;]</span>
<span class="sd">            </span>
<span class="sd">            x_set_ticks - a list of locations of x axis ticks</span>
<span class="sd">                   Default: [&#39;bottom&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">axes</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">,]</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">remove_spines</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">y_set_ticks</span><span class="p">:</span>  
                <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">x_set_ticks</span><span class="p">:</span>  
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()):</span>
                    <span class="n">item</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">set_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply the axis limits set by self.xlim and self.ylim</span>
<span class="sd">        to the graph axis&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">)</span>
            <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="k">else</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">use_mpld3</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">hide_volume_labels</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the figure and return an object for display</span>
<span class="sd">        This function is for viewing figures in a Jupyter notebook</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            legend   -  boolean for displaying a legend</span>
<span class="sd">                        Default: True</span>
<span class="sd">        </span>
<span class="sd">            update   -  boolean for reapplying spine, tick, title and </span>
<span class="sd">                        axis limits to the graph</span>
<span class="sd">                        Default: True</span>
<span class="sd">        </span>
<span class="sd">            use_mpld3 - boolean for using mpld3 to produce interactive html</span>
<span class="sd">                        Default: True</span>
<span class="sd">        </span>
<span class="sd">            hide_volume_labels - boolean for hiding x axis volume labels</span>
<span class="sd">                        Default: False</span>
<span class="sd">        </span>
<span class="sd">            **kw      - additional keyword arguments are passed to mpld3.display</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">legend</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_legend</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">legend</span> <span class="o">==</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_legend</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_spines_and_ticks</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_title_and_labels</span><span class="p">(</span><span class="n">hide_volume_labels</span> <span class="o">=</span> <span class="n">hide_volume_labels</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_limits</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">use_mpld3</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mpld3</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span>
    
    <span class="k">def</span> <span class="nf">save_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">template_type</span> <span class="o">=</span> <span class="s2">&quot;general&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the figure as a html file</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            fileobj  -  a python file object</span>
<span class="sd">                        Default: None (saved to a new file with the same</span>
<span class="sd">                                       name as the parent object with .html)</span>
<span class="sd">        </span>
<span class="sd">            legend   -  boolean for displaying a legend</span>
<span class="sd">                        Default: True</span>
<span class="sd">        </span>
<span class="sd">            update   -  boolean for reapplying spine, tick, title and </span>
<span class="sd">                        axis limits to the graph</span>
<span class="sd">                        Default: True</span>
<span class="sd">        </span>
<span class="sd">            template_type - string specifying the type of HTML template to use.</span>
<span class="sd">                        Options from mpld3 are:</span>
<span class="sd">                        &quot;simple&quot; suitable for simple html page with one figure.</span>
<span class="sd">                        Will fail if require.js is available on the page.</span>
<span class="sd">                        &quot;notebook&quot; assumes require.js and jquery are available.</span>
<span class="sd">                        &quot;general&quot; works both in and out of the notebook,</span>
<span class="sd">                        whether or not require.js and jquery are available</span>
<span class="sd">                        Default: general</span>
<span class="sd">        </span>
<span class="sd">            **kw      - additional keyword arguments are passed to mpld3.save_html</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_legend</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_legend</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">fileobj</span><span class="o">=</span><span class="s1">&#39;{0}.html&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_spines_and_ticks</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_title_and_labels</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_limits</span><span class="p">()</span>
        <span class="n">mpld3</span><span class="o">.</span><span class="n">save_html</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span>
                        <span class="n">fileobj</span><span class="o">=</span><span class="n">fileobj</span><span class="p">,</span>
                        <span class="n">template_type</span><span class="o">=</span><span class="n">template_type</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">save_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the figure as a pdf file</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            fileobj  -  a python file object</span>
<span class="sd">                        Default: None (saved to a new file with the same</span>
<span class="sd">                                       name as the parent object with .html)</span>
<span class="sd">        </span>
<span class="sd">            legend   -  boolean for displaying a legend</span>
<span class="sd">                        Default: True</span>
<span class="sd">        </span>
<span class="sd">            update   -  boolean for reapplying spine, tick, title and </span>
<span class="sd">                        axis limits to the graph</span>
<span class="sd">                        Default: True</span>
<span class="sd">        </span>
<span class="sd">            **kw      - additional keyword arguments are passed to </span>
<span class="sd">                        matplotlib.PdfPages.savefig</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_legend</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_legend</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_spines_and_ticks</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_title_and_labels</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_limits</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">fileobj</span><span class="o">=</span><span class="s1">&#39;{0}.html&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">matplotlib.backends.backend_pdf</span> <span class="kn">import</span> <span class="n">PdfPages</span>
        <span class="k">with</span> <span class="n">PdfPages</span><span class="p">(</span><span class="n">fileobj</span><span class="p">)</span> <span class="k">as</span> <span class="n">pdf</span><span class="p">:</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">add_individuals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                        <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                        <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add line plots of individual volume vs time for all individuals in</span>
<span class="sd">        a tumour volume table. These should be a logical group (eg treatment)</span>
<span class="sd">        When used to produce html plots mouse over events will make the line</span>
<span class="sd">        opaque (alpha=1.0) and label the line with the column name</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            name     -  The legend label for this group</span>
<span class="sd">        </span>
<span class="sd">            tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                        with individuals in columns and timepoints</span>
<span class="sd">                        as rows.  Individuals are removed from study</span>
<span class="sd">                        at the first NaN timepoint</span>
<span class="sd">        </span>
<span class="sd">            color    -  the color to plot this data group</span>
<span class="sd">                        Valid colors include matplotlib named colors</span>
<span class="sd">                        html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                        (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">        </span>
<span class="sd">            alpha    -  Percent transparency as a value between</span>
<span class="sd">                        0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">        </span>
<span class="sd">            lw       -  line width in points</span>
<span class="sd">        </span>
<span class="sd">            dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                        of on off lengths in points</span>
<span class="sd">        </span>
<span class="sd">            **kw     -  additional key word arguments are passed to</span>
<span class="sd">                        matplotlib.axes.plot and can be any</span>
<span class="sd">                        matplotlib.Line2D attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tv_table</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                                        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                                        <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">,</span>
                                        <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="n">plugins</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">HighlightLines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">name</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">name</span><span class="p">]):</span>
            <span class="n">plugins</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span>
                            <span class="n">plugins</span><span class="o">.</span><span class="n">LineLabelTooltip</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">tv_table</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
        <span class="k">pass</span>
        
    <span class="k">def</span> <span class="nf">add_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                        <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[],</span>
                        <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate and add to the plot a line for the mean volume vs time </span>
<span class="sd">        for all individuals in a tumour volume table. These individuals </span>
<span class="sd">        should be a logical group (eg treatment)</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            name     -  The legend label for this group</span>
<span class="sd">        </span>
<span class="sd">            tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                        with individuals in columns and timepoints</span>
<span class="sd">                        as rows.  Individuals are removed from study</span>
<span class="sd">                        at the first NaN timepoint</span>
<span class="sd">        </span>
<span class="sd">            threshold - the minimum group size to plot at a given</span>
<span class="sd">                        time point.</span>
<span class="sd">                        Default: 2</span>
<span class="sd">        </span>
<span class="sd">            color    -  the color to plot this data group</span>
<span class="sd">                        Valid colors include matplotlib named colors</span>
<span class="sd">                        html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                        (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">        </span>
<span class="sd">            alpha    -  Percent transparency as a value between</span>
<span class="sd">                        0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">        </span>
<span class="sd">            lw       -  line width in points</span>
<span class="sd">        </span>
<span class="sd">            dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                        of on off lengths in points</span>
<span class="sd">        </span>
<span class="sd">            **kw     -  additional key word arguments are passed to</span>
<span class="sd">                        matplotlib.axes.plot and can be any</span>
<span class="sd">                        matplotlib.Line2D attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tv_table</span><span class="p">[</span><span class="n">tv_table</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                                        <span class="n">tv_table</span><span class="p">[</span><span class="n">tv_table</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                                        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                                        <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">,</span>
                                        <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_calc_t_ci</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="mf">0.95</span><span class="p">):</span>
        <span class="n">uppers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">lowers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">means</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">tv_table</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">tv_table</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
            <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="p">(</span><span class="n">lower</span><span class="p">,</span><span class="n">upper</span><span class="p">)</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span>
                                <span class="n">df</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">loc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span>
                                <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)),</span>
                                <span class="p">)</span>
            <span class="n">uppers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>
            <span class="n">lowers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span>
            <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
        <span class="n">cis</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;mean&#39;</span><span class="p">:</span><span class="n">means</span><span class="p">,</span>
                              <span class="s1">&#39;lower bound&#39;</span><span class="p">:[</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lowers</span><span class="p">],</span> <span class="c1">#limit to +ve</span>
                              <span class="s1">&#39;upper bound&#39;</span><span class="p">:</span><span class="n">uppers</span><span class="p">,</span>
            <span class="p">})</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="n">cis</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">tv_table</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">cis</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">cis</span>
    
    
    <span class="k">def</span> <span class="nf">_calc_norm_ci</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="mf">0.95</span><span class="p">):</span>
        <span class="n">interval</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="n">ci</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">tv_table</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                                               <span class="n">scale</span><span class="o">=</span><span class="n">tv_table</span><span class="o">.</span><span class="n">sem</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">cis</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;mean&#39;</span><span class="p">:</span><span class="n">tv_table</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                              <span class="s1">&#39;lower bound&#39;</span><span class="p">:[</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="c1">#limit to +ve</span>
                              <span class="s1">&#39;upper bound&#39;</span><span class="p">:</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">})</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">cis</span>
    
    <span class="k">def</span> <span class="nf">add_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                        <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[],</span>
                        <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the confidence interval of the mean and add to the </span>
<span class="sd">        plot as a shaded band around the mean. These individuals should be a</span>
<span class="sd">        logical group (eg treatment).</span>
<span class="sd">        Note that the value is the confidence interval for the standard</span>
<span class="sd">        error of the mean and indicates the range the mean is expected</span>
<span class="sd">        to lie within ci % of the time.</span>
<span class="sd">        This should not be confused with the standard deviation of the data </span>
<span class="sd">        (the range within individual data is expected to lie) or the standard</span>
<span class="sd">        error of the mean.</span>
<span class="sd">        As most data is expected to have a small number of observations, the</span>
<span class="sd">        95% confidence interval is calculated using a t distribution.</span>
<span class="sd">        Results match R&#39;s t-test and Graphpad Prism&#39;s 95% CI</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            name     -  The legend label for this group</span>
<span class="sd">        </span>
<span class="sd">            tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                        with individuals in columns and timepoints</span>
<span class="sd">                        as rows.  Individuals are removed from study</span>
<span class="sd">                        at the first NaN timepoint</span>
<span class="sd">            </span>
<span class="sd">            threshold - the minimum group size to plot a confidence</span>
<span class="sd">                        interval for</span>
<span class="sd">                        Default: 2</span>
<span class="sd">        </span>
<span class="sd">            ci -        the confidence interval range to plot</span>
<span class="sd">                        Default: 0.95</span>
<span class="sd">        </span>
<span class="sd">            color    -  the color to plot this data group</span>
<span class="sd">                        Valid colors include matplotlib named colors</span>
<span class="sd">                        html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                        (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">        </span>
<span class="sd">            alpha    -  Percent transparency as a value between</span>
<span class="sd">                        0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">        </span>
<span class="sd">            lw       -  line width in points</span>
<span class="sd">        </span>
<span class="sd">            dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                        of on off lengths in points</span>
<span class="sd">        </span>
<span class="sd">            **kw     -  additional key word arguments are passed to</span>
<span class="sd">                        matplotlib.axes.fill_between</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_t_ci</span><span class="p">(</span><span class="n">tv_table</span><span class="p">[</span><span class="n">tv_table</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">],</span> <span class="n">ci</span><span class="o">=</span><span class="n">ci</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intervals</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cis</span><span class="o">.</span><span class="n">index</span><span class="p">],</span>
                                                   <span class="n">cis</span><span class="p">[</span><span class="s1">&#39;lower bound&#39;</span><span class="p">],</span>
                                                   <span class="n">cis</span><span class="p">[</span><span class="s1">&#39;upper bound&#39;</span><span class="p">],</span>
                                                   <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                                                   <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">,</span>
                                                   <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">set_title_and_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">hide_volume_labels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set plot titles and axis labels</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            title   -   main plot title</span>
<span class="sd">                        Default: None (uses self.title)</span>
<span class="sd">        </span>
<span class="sd">            ylabel  -   y axis label</span>
<span class="sd">                        Default: None (uses self.ylabel)</span>
<span class="sd">        </span>
<span class="sd">            xlabel  -   x axis label</span>
<span class="sd">                        Default: None (uses self.xlabel)</span>
<span class="sd">        </span>
<span class="sd">            hide_volume_labels - for compatibility with dual plot</span>
<span class="sd">                        Default: False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
        <span class="k">if</span> <span class="n">ylabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span>
        <span class="k">if</span> <span class="n">xlabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">xlabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">add_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a legend from axis data after removing any existing</span>
<span class="sd">        legends</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            loc   -   location of legend from: &#39;best&#39;,&#39;upper right&#39;,</span>
<span class="sd">                      &#39;upper left&#39;,&#39;lower left&#39;,&#39;lower right&#39;,&#39;right&#39;,</span>
<span class="sd">                      &#39;center left&#39;,&#39;center right&#39;,&#39;lower center&#39;,</span>
<span class="sd">                      &#39;upper center&#39;,&#39;center&#39;</span>
<span class="sd">                      Default: &#39;best&#39;</span>
<span class="sd">        </span>
<span class="sd">            **kw  -   keyword arguments passed to matplotlib.axes.legend</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_legend</span><span class="p">()</span>
        <span class="n">patches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">:</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>
            <span class="n">patches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],[],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">patches</span><span class="p">,</span>
                      <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span>
                      <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">show_treatment_days</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add rectangular patches on the x axis to indicate days</span>
<span class="sd">        on which treatment occurred.</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            days   -   an integer list of days eg [1,3,5]</span>
<span class="sd">        </span>
<span class="sd">            facecolor - the fill color for the rectangular patches</span>
<span class="sd">                        Valid colors include matplotlib named colors</span>
<span class="sd">                        html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                        (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">        </span>
<span class="sd">            lw     -   the width of the line bordering the patch in points</span>
<span class="sd">                       Default: 0 (no line)</span>
<span class="sd">        </span>
<span class="sd">            **kw  -   keyword arguments passed to matplotlib.patches.Rectangle</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">days</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">day</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">))</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">shade_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add rectangular fill the full height of the axis to indicate</span>
<span class="sd">        a date range (eg for treatment).</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            start   -   the start point of the rectangle</span>
<span class="sd">        </span>
<span class="sd">            end   -     the end point of the rectangle</span>
<span class="sd">        </span>
<span class="sd">            facecolor - the fill color for the rectangular patches</span>
<span class="sd">                        Valid colors include matplotlib named colors</span>
<span class="sd">                        html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                        (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">        </span>
<span class="sd">            alpha    -  Percent transparency as a value between</span>
<span class="sd">                        0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">                        Default: 0.2</span>
<span class="sd">        </span>
<span class="sd">            lw     -   the width of the line bordering the patch in points</span>
<span class="sd">                       Default: 0 (no line)</span>
<span class="sd">        </span>
<span class="sd">            **kw  -   keyword arguments passed to matplotlib.patches.Rectangle</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">miny</span><span class="p">,</span><span class="n">maxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">get_data_interval</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">start</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">miny</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">end</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">maxy</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                                                        <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">))</span>
        <span class="k">pass</span>
    

<span class="k">class</span> <span class="nc">VolumeSurvivalPlot</span><span class="p">(</span><span class="n">TumourVolumePlot</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initiate a new dual panel Tumour Volume and Survival plot object</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        km_size  -  The relative size of the survival plot</span>
<span class="sd">                    Default: 0.5 (ie half or 1/3 total plot area)</span>
<span class="sd">    </span>
<span class="sd">        vertical -  Stack the Tumour Volume plot over the survival plot</span>
<span class="sd">                    with a shared x axis (days) so events co occur.</span>
<span class="sd">                    Default: True</span>
<span class="sd">    </span>
<span class="sd">        **kw - keyword arguments are passed to</span>
<span class="sd">               matplotlib.pyplot.subplots</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">km_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">vertical</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;height_ratios&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="n">km_size</span><span class="p">]},</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width_ratios&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="n">km_size</span><span class="p">]},</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">means</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kmfs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intervals</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Untitled&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;Tumour Volume mm$^{3}$&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Days&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_title</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ylabel</span> <span class="o">=</span> <span class="s1">&#39;Survival&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_xlabel</span> <span class="o">=</span> <span class="s1">&#39;Days&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_yticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ci_show</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_show_censors</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertical</span> <span class="o">=</span> <span class="n">vertical</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volume_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">remove_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove any existing matplotlib axis legend&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">legend_</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">add_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                        <span class="n">endpoint</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span>
                        <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                        <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[],</span>
                        <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate and add to the plot a line for the mean volume vs time </span>
<span class="sd">        for all individuals in a tumour volume table. These individuals </span>
<span class="sd">        should be a logical group (eg treatment)</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            name     -  The legend label for this group</span>
<span class="sd">        </span>
<span class="sd">            tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                        with individuals in columns and timepoints</span>
<span class="sd">                        as rows.  Individuals are removed from study</span>
<span class="sd">                        at the first NaN timepoint</span>
<span class="sd">        </span>
<span class="sd">            endpoint -  the volume at which the endpoint is reached</span>
<span class="sd">                        Default: 700</span>
<span class="sd">        </span>
<span class="sd">            threshold - the minimum group size to plot at a given</span>
<span class="sd">                        time point.</span>
<span class="sd">                        Default: 2</span>
<span class="sd">        </span>
<span class="sd">            color    -  the color to plot this data group</span>
<span class="sd">                        Valid colors include matplotlib named colors</span>
<span class="sd">                        html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                        (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">        </span>
<span class="sd">            alpha    -  Percent transparency as a value between</span>
<span class="sd">                        0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">        </span>
<span class="sd">            lw       -  line width in points</span>
<span class="sd">                        Default: 4</span>
<span class="sd">        </span>
<span class="sd">            dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                        of on off lengths in points</span>
<span class="sd">        </span>
<span class="sd">            **kw     -  additional key word arguments are passed to</span>
<span class="sd">                        matplotlib.axes.plot and </span>
<span class="sd">                        lifelines.kmf.plot and can be any</span>
<span class="sd">                        matplotlib.Line2D attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">VolumeSurvivalPlot</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_mean</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="o">=</span><span class="n">tv_table</span><span class="p">,</span>
                        <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                        <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="n">dashes</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volume_data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tv_table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_kmf</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                     <span class="n">endpoint</span> <span class="o">=</span> <span class="n">endpoint</span><span class="p">,</span>
                     <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                     <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="n">dashes</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">add_kmf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                        <span class="n">endpoint</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                        <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[],</span>
                        <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate and add a Kaplan Meier curve to the second panel</span>
<span class="sd">        of the plot for all individuals in a tumour volume table.</span>
<span class="sd">        These individuals should be a logical group (eg treatment)</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            name     -  The legend label for this group</span>
<span class="sd">        </span>
<span class="sd">            tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                        with individuals in columns and timepoints</span>
<span class="sd">                        as rows.  Individuals are removed from study</span>
<span class="sd">                        at the first NaN timepoint</span>

<span class="sd">            endpoint -  the volume at which the endpoint is reached</span>
<span class="sd">                        Default: 700</span>
<span class="sd">        </span>
<span class="sd">            color    -  the color to plot this data group</span>
<span class="sd">                        Valid colors include matplotlib named colors</span>
<span class="sd">                        html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                        (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">        </span>
<span class="sd">            alpha    -  Percent transparency as a value between</span>
<span class="sd">                        0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">        </span>
<span class="sd">            lw       -  line width in points</span>
<span class="sd">                        Default: 4</span>
<span class="sd">        </span>
<span class="sd">            dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                        of on off lengths in points</span>
<span class="sd">        </span>
<span class="sd">            **kw     -  additional key word arguments are passed to</span>
<span class="sd">                        lifelines.kmf.plot and can be any</span>
<span class="sd">                        matplotlib.Line2D attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kmfs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_km</span><span class="p">(</span><span class="n">tv_table</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">endpoint</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kmfs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                     <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="n">dashes</span><span class="p">,</span>
                     <span class="n">show_censors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_show_censors</span><span class="p">,</span>
                     <span class="n">ci_show</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_ci_show</span><span class="p">,</span>
                     <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">set_title_and_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">km_title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">km_ylabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">km_xlabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">hide_volume_labels</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set plot titles and axis labels</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            title   -   main plot title</span>
<span class="sd">                        Default: None (uses self.title)</span>
<span class="sd">        </span>
<span class="sd">            ylabel  -   y axis label</span>
<span class="sd">                        Default: None (uses self.ylabel)</span>
<span class="sd">        </span>
<span class="sd">            xlabel  -   x axis label</span>
<span class="sd">                        Default: None (uses self.xlabel)</span>
<span class="sd">        </span>
<span class="sd">            kmtitle   - Kaplan Meier plot label</span>
<span class="sd">                        Default: None (uses self.km_title)</span>
<span class="sd">        </span>
<span class="sd">            ylabel  -   y axis label</span>
<span class="sd">                        Default: None (uses self.km_ylabel)</span>
<span class="sd">        </span>
<span class="sd">            xlabel  -   x axis label</span>
<span class="sd">                        Default: None (uses self.km_xlabel)</span>
<span class="sd">        </span>
<span class="sd">            hide_volume_labels - do not display x axis label</span>
<span class="sd">                        between volume plot and Kaplan-Meier</span>
<span class="sd">                        Default: True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
        <span class="k">if</span> <span class="n">ylabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span>
        <span class="k">if</span> <span class="n">xlabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">xlabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span>
        <span class="k">if</span> <span class="n">km_title</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">km_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_title</span>
        <span class="k">if</span> <span class="n">km_ylabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">km_ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_ylabel</span>
        <span class="k">if</span> <span class="n">km_xlabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">km_xlabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_xlabel</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span> <span class="ow">and</span> <span class="ow">not</span> <span class="s1">&#39;fontsize&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
            <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">hide_volume_labels</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">km_title</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">km_ylabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">km_xlabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">set_spines_and_ticks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                            <span class="n">remove_spines</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="s1">&#39;top&#39;</span><span class="p">],</span>
                            <span class="n">y_set_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span>
                            <span class="n">x_set_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">],</span>
                            <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set spines (the lines along the axis) and</span>
<span class="sd">        tick locations for the plot</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">            </span>
<span class="sd">            axes - the matplotlib.axis object to act on</span>
<span class="sd">                   Default: None</span>
<span class="sd">                   (interpreted as self.ax and self.km_ax)</span>
<span class="sd">            </span>
<span class="sd">            remove_spines - a list of spines to remove.</span>
<span class="sd">                   Default: [&#39;right&#39;,&#39;top&#39;]</span>
<span class="sd">            </span>
<span class="sd">            y_set_ticks - a list of locations of y axis ticks</span>
<span class="sd">                   Default: [&#39;left&#39;]</span>
<span class="sd">            </span>
<span class="sd">            x_set_ticks - a list of locations of x axis ticks</span>
<span class="sd">                   Default: [&#39;bottom&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">]</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">VolumeSurvivalPlot</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set_spines_and_ticks</span><span class="p">(</span><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">,</span>
                                                            <span class="n">remove_spines</span> <span class="o">=</span> <span class="n">remove_spines</span><span class="p">,</span>
                                                            <span class="n">y_set_ticks</span> <span class="o">=</span> <span class="n">y_set_ticks</span><span class="p">,</span>
                                                            <span class="n">x_set_ticks</span> <span class="o">=</span> <span class="n">x_set_ticks</span><span class="p">,)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">km_yticks</span><span class="p">)</span>
        
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">set_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply the axis limits set by self.xlim and self.ylim</span>
<span class="sd">        to the graph axes.  The Kaplan-Meier y axis will remain</span>
<span class="sd">        [0,1.02]&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">)</span>
            <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="k">else</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.02</span><span class="p">])</span> <span class="c1">#set &gt;1 so lines retain full width</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.02</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">logrank_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">treatment_a</span><span class="p">,</span> <span class="n">treatment_b</span><span class="p">,</span> <span class="n">t1error</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate a log rank test (Mantel-Cox) statistic between two treatments</span>
<span class="sd">        Calls lifelines.statistics.logrank_test for calculation.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            treatment_a     -  The legend label for this group as used</span>
<span class="sd">                               with add_mean.</span>

<span class="sd">            treatment_b     -  The legend label for this group as used</span>
<span class="sd">                               with add_mean.</span>

<span class="sd">            t1error         -  probability of a type 1 error (alpha)</span>
<span class="sd">                               Default: 0.05</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume_data</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;you need to add data with .add_mean() before using logrank_test&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>
        <span class="n">survival_a</span> <span class="o">=</span> <span class="n">volume_to_survival</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume_data</span><span class="p">[</span><span class="n">treatment_a</span><span class="p">],</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="p">)</span>
        <span class="n">survival_b</span> <span class="o">=</span> <span class="n">volume_to_survival</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume_data</span><span class="p">[</span><span class="n">treatment_b</span><span class="p">],</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">logrank_test</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">survival_a</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]),</span>
                                                   <span class="nb">list</span><span class="p">(</span><span class="n">survival_b</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]),</span>
                                                   <span class="nb">list</span><span class="p">(</span><span class="n">survival_a</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">]),</span>
                                                   <span class="nb">list</span><span class="p">(</span><span class="n">survival_b</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">]),</span>
                                                   <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">t1error</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">print_summary</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span>
    
    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">use_mpld3</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">hide_volume_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Display the dual tumour volume and Kaplan Meier plot</span>
<span class="sd">        KNOWN BUG - mpld3 does not correctly display the step plot in version &lt; 0.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">VolumeSurvivalPlot</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span>
                                                <span class="n">use_mpld3</span><span class="o">=</span><span class="n">use_mpld3</span><span class="p">,</span>
                                                <span class="n">update</span><span class="o">=</span><span class="n">update</span><span class="p">,</span>
                                                <span class="n">hide_volume_labels</span> <span class="o">=</span> <span class="n">hide_volume_labels</span><span class="p">,</span>
                                                <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_mpld3</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="plot.get_survival_status">
    <p>def <span class="ident">get_survival_status</span>(</p><p>tv_series, endpoint=700)</p>
    </div>
    

    
  
    <div class="desc"><p>Convert a pandas series of tumour volume measurements
organised with one individual per column and indexed by time
to a pandas data frame with columns for time and endpoint observed
(the inverse of censored) and indexed by individual.</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>tv_series - a pandas series of tumour volume measurements
            indexed by time

endpoint  - the volume threshold at which and endpoint
            event is deemed to have occurred
</pre></div>


<p>Returns:</p>
<div class="codehilite"><pre><span></span>time      - the last time index observed

observed  - a boolean for whether the endpoint has
            been reached (inverse of censored status)
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.get_survival_status', this);">Show source &equiv;</a></p>
  <div id="source-plot.get_survival_status" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_survival_status</span><span class="p">(</span><span class="n">tv_series</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="mi">700</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a pandas series of tumour volume measurements</span>
<span class="sd">    organised with one individual per column and indexed by time</span>
<span class="sd">    to a pandas data frame with columns for time and endpoint observed</span>
<span class="sd">    (the inverse of censored) and indexed by individual.</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        tv_series - a pandas series of tumour volume measurements</span>
<span class="sd">                    indexed by time</span>
<span class="sd">    </span>
<span class="sd">        endpoint  - the volume threshold at which and endpoint</span>
<span class="sd">                    event is deemed to have occurred</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    </span>
<span class="sd">        time      - the last time index observed</span>
<span class="sd">    </span>
<span class="sd">        observed  - a boolean for whether the endpoint has</span>
<span class="sd">                    been reached (inverse of censored status)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tv_series</span> <span class="o">=</span> <span class="n">tv_series</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">observed</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tv_series</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">endpoint</span><span class="p">:</span>
            <span class="n">observed</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="n">tv_series</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">observed</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">tv_series</span><span class="p">)</span>
        <span class="k">raise</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="plot.make_km">
    <p>def <span class="ident">make_km</span>(</p><p>tv_data, label=&#39;Untitled&#39;, endpoint=700)</p>
    </div>
    

    
  
    <div class="desc"><p>Construct a Kaplan-Meier function for a dataframe
of tumour volume measurements</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>tv_data  - a pandas data frame of volume measurements
           with individuals in columns and timepoints
           as rows.  Individuals are removed from study
           at the first NaN timepoint

label    - a title for this grouping

endpoint - the volume at which the endpoint is reached
           Default: 700
</pre></div>


<p>Returns:</p>
<div class="codehilite"><pre><span></span>a lifelines KaplanMeierFitter object
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.make_km', this);">Show source &equiv;</a></p>
  <div id="source-plot.make_km" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">make_km</span><span class="p">(</span><span class="n">tv_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Untitled&#39;</span><span class="p">,</span><span class="n">endpoint</span><span class="o">=</span><span class="mi">700</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Construct a Kaplan-Meier function for a dataframe</span>
<span class="sd">    of tumour volume measurements</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        tv_data  - a pandas data frame of volume measurements</span>
<span class="sd">                   with individuals in columns and timepoints</span>
<span class="sd">                   as rows.  Individuals are removed from study</span>
<span class="sd">                   at the first NaN timepoint</span>
<span class="sd">    </span>
<span class="sd">        label    - a title for this grouping</span>
<span class="sd">    </span>
<span class="sd">        endpoint - the volume at which the endpoint is reached</span>
<span class="sd">                   Default: 700</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    </span>
<span class="sd">        a lifelines KaplanMeierFitter object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">survival</span> <span class="o">=</span> <span class="n">volume_to_survival</span><span class="p">(</span><span class="n">tv_data</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">)</span>
    <span class="n">kmf</span> <span class="o">=</span> <span class="n">lifelines</span><span class="o">.</span><span class="n">KaplanMeierFitter</span><span class="p">()</span>
    <span class="n">kmf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">survival</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">event_observed</span><span class="o">=</span><span class="n">survival</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kmf</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="plot.version">
    <p>def <span class="ident">version</span>(</p><p>)</p>
    </div>
    

    
  
    <div class="desc"><p>Return the symatic versioning format version number</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.version', this);">Show source &equiv;</a></p>
  <div id="source-plot.version" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">version</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Return the symatic versioning format version number&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">__version__</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="plot.volume_to_survival">
    <p>def <span class="ident">volume_to_survival</span>(</p><p>tv_data, endpoint=700)</p>
    </div>
    

    
  
    <div class="desc"><p>Convert a pandas data frame of tumour volume measurements
organised with one individual per column and indexed by time
to a pandas data frame with columns for time and endpoint observed
(the inverse of censored) and indexed by individual.</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>tv_data   - a pandas data frame of volume measurements
            arranged with individuals in columns and
            indexed by time

endpoint  - the volume threshold at which and endpoint
            event is deemed to have occurred
</pre></div>


<p>Returns:</p>
<div class="codehilite"><pre><span></span>A pandas data frame with columns &#39;Time&#39; and &#39;Observed&#39;
indexed by individuals (column names in tv_data)
Time      - the last time index observed
Observed  - a boolean for whether the endpoint has
            been reached (inverse of censored status)
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.volume_to_survival', this);">Show source &equiv;</a></p>
  <div id="source-plot.volume_to_survival" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">volume_to_survival</span><span class="p">(</span><span class="n">tv_data</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="mi">700</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a pandas data frame of tumour volume measurements</span>
<span class="sd">    organised with one individual per column and indexed by time</span>
<span class="sd">    to a pandas data frame with columns for time and endpoint observed</span>
<span class="sd">    (the inverse of censored) and indexed by individual.</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        tv_data   - a pandas data frame of volume measurements</span>
<span class="sd">                    arranged with individuals in columns and</span>
<span class="sd">                    indexed by time</span>
<span class="sd">    </span>
<span class="sd">        endpoint  - the volume threshold at which and endpoint</span>
<span class="sd">                    event is deemed to have occurred</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    </span>
<span class="sd">        A pandas data frame with columns &#39;Time&#39; and &#39;Observed&#39;</span>
<span class="sd">        indexed by individuals (column names in tv_data)</span>
<span class="sd">        Time      - the last time index observed</span>
<span class="sd">        Observed  - a boolean for whether the endpoint has</span>
<span class="sd">                    been reached (inverse of censored status)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">survival</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                        <span class="p">{</span><span class="n">x</span><span class="p">:</span><span class="n">get_survival_status</span><span class="p">(</span><span class="n">tv_data</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">)</span> \
                        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tv_data</span> <span class="k">if</span> <span class="n">tv_data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">any</span><span class="p">()}</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">survival</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="s1">&#39;Observed&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">survival</span>
</pre></div>

  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="plot.HighlightLines" class="name">class <span class="ident">HighlightLines</span></p>
      
  
    <div class="desc"><p>A plugin to highlight lines on hover
Adapted from mpld3 example code</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.HighlightLines', this);">Show source &equiv;</a></p>
  <div id="source-plot.HighlightLines" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">HighlightLines</span><span class="p">(</span><span class="n">plugins</span><span class="o">.</span><span class="n">PluginBase</span><span class="p">):</span> <span class="c1">#pragma non cover</span>
    <span class="sd">&quot;&quot;&quot;A plugin to highlight lines on hover</span>
<span class="sd">    Adapted from mpld3 example code&quot;&quot;&quot;</span>

    <span class="n">JAVASCRIPT</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    mpld3.register_plugin(&quot;linehighlight&quot;, LineHighlightPlugin);</span>
<span class="s2">    LineHighlightPlugin.prototype = Object.create(mpld3.Plugin.prototype);</span>
<span class="s2">    LineHighlightPlugin.prototype.constructor = LineHighlightPlugin;</span>
<span class="s2">    LineHighlightPlugin.prototype.requiredProps = [&quot;line_ids&quot;];</span>
<span class="s2">    LineHighlightPlugin.prototype.defaultProps = {alpha_bg:0.3, alpha_fg:1.0}</span>
<span class="s2">    function LineHighlightPlugin(fig, props){</span>
<span class="s2">        mpld3.Plugin.call(this, fig, props);</span>
<span class="s2">    };</span>

<span class="s2">    LineHighlightPlugin.prototype.draw = function(){</span>
<span class="s2">      for(var i=0; i&lt;this.props.line_ids.length; i++){</span>
<span class="s2">         var obj = mpld3.get_element(this.props.line_ids[i], this.fig),</span>
<span class="s2">             alpha_fg = this.props.alpha_fg;</span>
<span class="s2">             alpha_bg = this.props.alpha_bg;</span>
<span class="s2">         obj.elements()</span>
<span class="s2">             .on(&quot;mouseover.highlight&quot;, function(d, i){</span>
<span class="s2">                            d3.select(this).transition().duration(50)</span>
<span class="s2">                              .style(&quot;stroke-opacity&quot;, alpha_fg); })</span>
<span class="s2">             .on(&quot;mouseout.highlight&quot;, function(d, i){</span>
<span class="s2">                            d3.select(this).transition().duration(200)</span>
<span class="s2">                              .style(&quot;stroke-opacity&quot;, alpha_bg); });</span>
<span class="s2">      }</span>
<span class="s2">    };</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;linehighlight&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;line_ids&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">utils</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">],</span>
                      <span class="s2">&quot;alpha_bg&quot;</span><span class="p">:</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_alpha</span><span class="p">(),</span>
                      <span class="s2">&quot;alpha_fg&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#plot.HighlightLines">HighlightLines</a></li>
          <li>mpld3.plugins.PluginBase</li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="plot.HighlightLines.JAVASCRIPT" class="name">var <span class="ident">JAVASCRIPT</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="plot.HighlightLines.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, lines)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.HighlightLines.__init__', this);">Show source &equiv;</a></p>
  <div id="source-plot.HighlightLines.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dict_</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;linehighlight&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;line_ids&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">utils</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">],</span>
                  <span class="s2">&quot;alpha_bg&quot;</span><span class="p">:</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_alpha</span><span class="p">(),</span>
                  <span class="s2">&quot;alpha_fg&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.HighlightLines.css">
    <p>def <span class="ident">css</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.HighlightLines.css', this);">Show source &equiv;</a></p>
  <div id="source-plot.HighlightLines.css" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">css</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;css_&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">css_</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.HighlightLines.get_dict">
    <p>def <span class="ident">get_dict</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.HighlightLines.get_dict', this);">Show source &equiv;</a></p>
  <div id="source-plot.HighlightLines.get_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.HighlightLines.javascript">
    <p>def <span class="ident">javascript</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.HighlightLines.javascript', this);">Show source &equiv;</a></p>
  <div id="source-plot.HighlightLines.javascript" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">javascript</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;JAVASCRIPT&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;js_args_&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">JAVASCRIPT</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">js_args_</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">JAVASCRIPT</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="plot.HighlightLines.dict_" class="name">var <span class="ident">dict_</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.HighlightLines.lines" class="name">var <span class="ident">lines</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="plot.TumourVolumePlot" class="name">class <span class="ident">TumourVolumePlot</span></p>
      
  
    <div class="desc"><p>Construct a plot of volume vs time
This plot is designed to consist of measurements for individuals,
a mean volume for the group and a standard error of the mean.
When used to produce html the resulting graph is interactive with
mouse over highlighting of individuals and labeling with the column
name.  Static pdfs can also be generated.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.TumourVolumePlot', this);">Show source &equiv;</a></p>
  <div id="source-plot.TumourVolumePlot" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">TumourVolumePlot</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Construct a plot of volume vs time</span>
<span class="sd">    This plot is designed to consist of measurements for individuals,</span>
<span class="sd">    a mean volume for the group and a standard error of the mean.</span>
<span class="sd">    When used to produce html the resulting graph is interactive with</span>
<span class="sd">    mouse over highlighting of individuals and labeling with the column</span>
<span class="sd">    name.  Static pdfs can also be generated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initiate a new tumour TumourVolumePlot object</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            **kw - keyword arguments are passed to</span>
<span class="sd">                   matplotlib.pyplot.subplots</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">means</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intervals</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Untitled&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;Tumour Volume mm$^{3}$&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Days&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">remove_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove any existing matplotlib axis legend&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">set_spines_and_ticks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                            <span class="n">remove_spines</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="s1">&#39;top&#39;</span><span class="p">],</span>
                            <span class="n">y_set_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span>
                            <span class="n">x_set_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">],</span>
                            <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set spines (the lines along the axis) and</span>
<span class="sd">        tick locations for the plot</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">            </span>
<span class="sd">            axes - the matplotlib.axis object to act on</span>
<span class="sd">                   Default: None (interpreted as self.ax)</span>
<span class="sd">            </span>
<span class="sd">            remove_spines - a list of spines to remove.</span>
<span class="sd">                   Default: [&#39;right&#39;,&#39;top&#39;]</span>
<span class="sd">            </span>
<span class="sd">            y_set_ticks - a list of locations of y axis ticks</span>
<span class="sd">                   Default: [&#39;left&#39;]</span>
<span class="sd">            </span>
<span class="sd">            x_set_ticks - a list of locations of x axis ticks</span>
<span class="sd">                   Default: [&#39;bottom&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">axes</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">,]</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">remove_spines</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">y_set_ticks</span><span class="p">:</span>  
                <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">x_set_ticks</span><span class="p">:</span>  
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()):</span>
                    <span class="n">item</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">set_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply the axis limits set by self.xlim and self.ylim</span>
<span class="sd">        to the graph axis&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">)</span>
            <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="k">else</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">use_mpld3</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">hide_volume_labels</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the figure and return an object for display</span>
<span class="sd">        This function is for viewing figures in a Jupyter notebook</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            legend   -  boolean for displaying a legend</span>
<span class="sd">                        Default: True</span>
<span class="sd">        </span>
<span class="sd">            update   -  boolean for reapplying spine, tick, title and </span>
<span class="sd">                        axis limits to the graph</span>
<span class="sd">                        Default: True</span>
<span class="sd">        </span>
<span class="sd">            use_mpld3 - boolean for using mpld3 to produce interactive html</span>
<span class="sd">                        Default: True</span>
<span class="sd">        </span>
<span class="sd">            hide_volume_labels - boolean for hiding x axis volume labels</span>
<span class="sd">                        Default: False</span>
<span class="sd">        </span>
<span class="sd">            **kw      - additional keyword arguments are passed to mpld3.display</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">legend</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_legend</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">legend</span> <span class="o">==</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_legend</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_spines_and_ticks</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_title_and_labels</span><span class="p">(</span><span class="n">hide_volume_labels</span> <span class="o">=</span> <span class="n">hide_volume_labels</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_limits</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">use_mpld3</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mpld3</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span>
    
    <span class="k">def</span> <span class="nf">save_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">template_type</span> <span class="o">=</span> <span class="s2">&quot;general&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the figure as a html file</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            fileobj  -  a python file object</span>
<span class="sd">                        Default: None (saved to a new file with the same</span>
<span class="sd">                                       name as the parent object with .html)</span>
<span class="sd">        </span>
<span class="sd">            legend   -  boolean for displaying a legend</span>
<span class="sd">                        Default: True</span>
<span class="sd">        </span>
<span class="sd">            update   -  boolean for reapplying spine, tick, title and </span>
<span class="sd">                        axis limits to the graph</span>
<span class="sd">                        Default: True</span>
<span class="sd">        </span>
<span class="sd">            template_type - string specifying the type of HTML template to use.</span>
<span class="sd">                        Options from mpld3 are:</span>
<span class="sd">                        &quot;simple&quot; suitable for simple html page with one figure.</span>
<span class="sd">                        Will fail if require.js is available on the page.</span>
<span class="sd">                        &quot;notebook&quot; assumes require.js and jquery are available.</span>
<span class="sd">                        &quot;general&quot; works both in and out of the notebook,</span>
<span class="sd">                        whether or not require.js and jquery are available</span>
<span class="sd">                        Default: general</span>
<span class="sd">        </span>
<span class="sd">            **kw      - additional keyword arguments are passed to mpld3.save_html</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_legend</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_legend</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">fileobj</span><span class="o">=</span><span class="s1">&#39;{0}.html&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_spines_and_ticks</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_title_and_labels</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_limits</span><span class="p">()</span>
        <span class="n">mpld3</span><span class="o">.</span><span class="n">save_html</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span>
                        <span class="n">fileobj</span><span class="o">=</span><span class="n">fileobj</span><span class="p">,</span>
                        <span class="n">template_type</span><span class="o">=</span><span class="n">template_type</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">save_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the figure as a pdf file</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            fileobj  -  a python file object</span>
<span class="sd">                        Default: None (saved to a new file with the same</span>
<span class="sd">                                       name as the parent object with .html)</span>
<span class="sd">        </span>
<span class="sd">            legend   -  boolean for displaying a legend</span>
<span class="sd">                        Default: True</span>
<span class="sd">        </span>
<span class="sd">            update   -  boolean for reapplying spine, tick, title and </span>
<span class="sd">                        axis limits to the graph</span>
<span class="sd">                        Default: True</span>
<span class="sd">        </span>
<span class="sd">            **kw      - additional keyword arguments are passed to </span>
<span class="sd">                        matplotlib.PdfPages.savefig</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_legend</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_legend</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_spines_and_ticks</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_title_and_labels</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_limits</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span>
            <span class="n">fileobj</span><span class="o">=</span><span class="s1">&#39;{0}.html&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">matplotlib.backends.backend_pdf</span> <span class="kn">import</span> <span class="n">PdfPages</span>
        <span class="k">with</span> <span class="n">PdfPages</span><span class="p">(</span><span class="n">fileobj</span><span class="p">)</span> <span class="k">as</span> <span class="n">pdf</span><span class="p">:</span>
            <span class="n">pdf</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">add_individuals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                        <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                        <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add line plots of individual volume vs time for all individuals in</span>
<span class="sd">        a tumour volume table. These should be a logical group (eg treatment)</span>
<span class="sd">        When used to produce html plots mouse over events will make the line</span>
<span class="sd">        opaque (alpha=1.0) and label the line with the column name</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            name     -  The legend label for this group</span>
<span class="sd">        </span>
<span class="sd">            tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                        with individuals in columns and timepoints</span>
<span class="sd">                        as rows.  Individuals are removed from study</span>
<span class="sd">                        at the first NaN timepoint</span>
<span class="sd">        </span>
<span class="sd">            color    -  the color to plot this data group</span>
<span class="sd">                        Valid colors include matplotlib named colors</span>
<span class="sd">                        html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                        (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">        </span>
<span class="sd">            alpha    -  Percent transparency as a value between</span>
<span class="sd">                        0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">        </span>
<span class="sd">            lw       -  line width in points</span>
<span class="sd">        </span>
<span class="sd">            dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                        of on off lengths in points</span>
<span class="sd">        </span>
<span class="sd">            **kw     -  additional key word arguments are passed to</span>
<span class="sd">                        matplotlib.axes.plot and can be any</span>
<span class="sd">                        matplotlib.Line2D attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tv_table</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                                        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                                        <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">,</span>
                                        <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="n">plugins</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">HighlightLines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">name</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">name</span><span class="p">]):</span>
            <span class="n">plugins</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span>
                            <span class="n">plugins</span><span class="o">.</span><span class="n">LineLabelTooltip</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">tv_table</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
        <span class="k">pass</span>
        
    <span class="k">def</span> <span class="nf">add_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                        <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[],</span>
                        <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate and add to the plot a line for the mean volume vs time </span>
<span class="sd">        for all individuals in a tumour volume table. These individuals </span>
<span class="sd">        should be a logical group (eg treatment)</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            name     -  The legend label for this group</span>
<span class="sd">        </span>
<span class="sd">            tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                        with individuals in columns and timepoints</span>
<span class="sd">                        as rows.  Individuals are removed from study</span>
<span class="sd">                        at the first NaN timepoint</span>
<span class="sd">        </span>
<span class="sd">            threshold - the minimum group size to plot at a given</span>
<span class="sd">                        time point.</span>
<span class="sd">                        Default: 2</span>
<span class="sd">        </span>
<span class="sd">            color    -  the color to plot this data group</span>
<span class="sd">                        Valid colors include matplotlib named colors</span>
<span class="sd">                        html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                        (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">        </span>
<span class="sd">            alpha    -  Percent transparency as a value between</span>
<span class="sd">                        0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">        </span>
<span class="sd">            lw       -  line width in points</span>
<span class="sd">        </span>
<span class="sd">            dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                        of on off lengths in points</span>
<span class="sd">        </span>
<span class="sd">            **kw     -  additional key word arguments are passed to</span>
<span class="sd">                        matplotlib.axes.plot and can be any</span>
<span class="sd">                        matplotlib.Line2D attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tv_table</span><span class="p">[</span><span class="n">tv_table</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                                        <span class="n">tv_table</span><span class="p">[</span><span class="n">tv_table</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                                        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                                        <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">,</span>
                                        <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_calc_t_ci</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="mf">0.95</span><span class="p">):</span>
        <span class="n">uppers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">lowers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">means</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">tv_table</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">tv_table</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
            <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="p">(</span><span class="n">lower</span><span class="p">,</span><span class="n">upper</span><span class="p">)</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span>
                                <span class="n">df</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">loc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span>
                                <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)),</span>
                                <span class="p">)</span>
            <span class="n">uppers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>
            <span class="n">lowers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span>
            <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
        <span class="n">cis</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;mean&#39;</span><span class="p">:</span><span class="n">means</span><span class="p">,</span>
                              <span class="s1">&#39;lower bound&#39;</span><span class="p">:[</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lowers</span><span class="p">],</span> <span class="c1">#limit to +ve</span>
                              <span class="s1">&#39;upper bound&#39;</span><span class="p">:</span><span class="n">uppers</span><span class="p">,</span>
            <span class="p">})</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="n">cis</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">tv_table</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">cis</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">cis</span>
    
    
    <span class="k">def</span> <span class="nf">_calc_norm_ci</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="mf">0.95</span><span class="p">):</span>
        <span class="n">interval</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="n">ci</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">tv_table</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                                               <span class="n">scale</span><span class="o">=</span><span class="n">tv_table</span><span class="o">.</span><span class="n">sem</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">cis</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;mean&#39;</span><span class="p">:</span><span class="n">tv_table</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                              <span class="s1">&#39;lower bound&#39;</span><span class="p">:[</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="c1">#limit to +ve</span>
                              <span class="s1">&#39;upper bound&#39;</span><span class="p">:</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">})</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">cis</span>
    
    <span class="k">def</span> <span class="nf">add_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                        <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[],</span>
                        <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the confidence interval of the mean and add to the </span>
<span class="sd">        plot as a shaded band around the mean. These individuals should be a</span>
<span class="sd">        logical group (eg treatment).</span>
<span class="sd">        Note that the value is the confidence interval for the standard</span>
<span class="sd">        error of the mean and indicates the range the mean is expected</span>
<span class="sd">        to lie within ci % of the time.</span>
<span class="sd">        This should not be confused with the standard deviation of the data </span>
<span class="sd">        (the range within individual data is expected to lie) or the standard</span>
<span class="sd">        error of the mean.</span>
<span class="sd">        As most data is expected to have a small number of observations, the</span>
<span class="sd">        95% confidence interval is calculated using a t distribution.</span>
<span class="sd">        Results match R&#39;s t-test and Graphpad Prism&#39;s 95% CI</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            name     -  The legend label for this group</span>
<span class="sd">        </span>
<span class="sd">            tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                        with individuals in columns and timepoints</span>
<span class="sd">                        as rows.  Individuals are removed from study</span>
<span class="sd">                        at the first NaN timepoint</span>
<span class="sd">            </span>
<span class="sd">            threshold - the minimum group size to plot a confidence</span>
<span class="sd">                        interval for</span>
<span class="sd">                        Default: 2</span>
<span class="sd">        </span>
<span class="sd">            ci -        the confidence interval range to plot</span>
<span class="sd">                        Default: 0.95</span>
<span class="sd">        </span>
<span class="sd">            color    -  the color to plot this data group</span>
<span class="sd">                        Valid colors include matplotlib named colors</span>
<span class="sd">                        html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                        (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">        </span>
<span class="sd">            alpha    -  Percent transparency as a value between</span>
<span class="sd">                        0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">        </span>
<span class="sd">            lw       -  line width in points</span>
<span class="sd">        </span>
<span class="sd">            dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                        of on off lengths in points</span>
<span class="sd">        </span>
<span class="sd">            **kw     -  additional key word arguments are passed to</span>
<span class="sd">                        matplotlib.axes.fill_between</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_t_ci</span><span class="p">(</span><span class="n">tv_table</span><span class="p">[</span><span class="n">tv_table</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">],</span> <span class="n">ci</span><span class="o">=</span><span class="n">ci</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intervals</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cis</span><span class="o">.</span><span class="n">index</span><span class="p">],</span>
                                                   <span class="n">cis</span><span class="p">[</span><span class="s1">&#39;lower bound&#39;</span><span class="p">],</span>
                                                   <span class="n">cis</span><span class="p">[</span><span class="s1">&#39;upper bound&#39;</span><span class="p">],</span>
                                                   <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                                                   <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">,</span>
                                                   <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">set_title_and_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">hide_volume_labels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set plot titles and axis labels</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            title   -   main plot title</span>
<span class="sd">                        Default: None (uses self.title)</span>
<span class="sd">        </span>
<span class="sd">            ylabel  -   y axis label</span>
<span class="sd">                        Default: None (uses self.ylabel)</span>
<span class="sd">        </span>
<span class="sd">            xlabel  -   x axis label</span>
<span class="sd">                        Default: None (uses self.xlabel)</span>
<span class="sd">        </span>
<span class="sd">            hide_volume_labels - for compatibility with dual plot</span>
<span class="sd">                        Default: False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
        <span class="k">if</span> <span class="n">ylabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span>
        <span class="k">if</span> <span class="n">xlabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">xlabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">add_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a legend from axis data after removing any existing</span>
<span class="sd">        legends</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            loc   -   location of legend from: &#39;best&#39;,&#39;upper right&#39;,</span>
<span class="sd">                      &#39;upper left&#39;,&#39;lower left&#39;,&#39;lower right&#39;,&#39;right&#39;,</span>
<span class="sd">                      &#39;center left&#39;,&#39;center right&#39;,&#39;lower center&#39;,</span>
<span class="sd">                      &#39;upper center&#39;,&#39;center&#39;</span>
<span class="sd">                      Default: &#39;best&#39;</span>
<span class="sd">        </span>
<span class="sd">            **kw  -   keyword arguments passed to matplotlib.axes.legend</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_legend</span><span class="p">()</span>
        <span class="n">patches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">:</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>
            <span class="n">patches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],[],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">patches</span><span class="p">,</span>
                      <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span>
                      <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">show_treatment_days</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add rectangular patches on the x axis to indicate days</span>
<span class="sd">        on which treatment occurred.</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            days   -   an integer list of days eg [1,3,5]</span>
<span class="sd">        </span>
<span class="sd">            facecolor - the fill color for the rectangular patches</span>
<span class="sd">                        Valid colors include matplotlib named colors</span>
<span class="sd">                        html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                        (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">        </span>
<span class="sd">            lw     -   the width of the line bordering the patch in points</span>
<span class="sd">                       Default: 0 (no line)</span>
<span class="sd">        </span>
<span class="sd">            **kw  -   keyword arguments passed to matplotlib.patches.Rectangle</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">days</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">day</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">))</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">shade_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add rectangular fill the full height of the axis to indicate</span>
<span class="sd">        a date range (eg for treatment).</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            start   -   the start point of the rectangle</span>
<span class="sd">        </span>
<span class="sd">            end   -     the end point of the rectangle</span>
<span class="sd">        </span>
<span class="sd">            facecolor - the fill color for the rectangular patches</span>
<span class="sd">                        Valid colors include matplotlib named colors</span>
<span class="sd">                        html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                        (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">        </span>
<span class="sd">            alpha    -  Percent transparency as a value between</span>
<span class="sd">                        0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">                        Default: 0.2</span>
<span class="sd">        </span>
<span class="sd">            lw     -   the width of the line bordering the patch in points</span>
<span class="sd">                       Default: 0 (no line)</span>
<span class="sd">        </span>
<span class="sd">            **kw  -   keyword arguments passed to matplotlib.patches.Rectangle</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">miny</span><span class="p">,</span><span class="n">maxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">get_data_interval</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">start</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">miny</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">end</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">maxy</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                                                        <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">))</span>
        <span class="k">pass</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#plot.TumourVolumePlot">TumourVolumePlot</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="plot.TumourVolumePlot.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Initiate a new tumour TumourVolumePlot object</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>**kw - keyword arguments are passed to
       matplotlib.pyplot.subplots
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.TumourVolumePlot.__init__', this);">Show source &equiv;</a></p>
  <div id="source-plot.TumourVolumePlot.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initiate a new tumour TumourVolumePlot object</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        **kw - keyword arguments are passed to</span>
<span class="sd">               matplotlib.pyplot.subplots</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">means</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">intervals</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Untitled&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;Tumour Volume mm$^{3}$&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Days&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.TumourVolumePlot.add_individuals">
    <p>def <span class="ident">add_individuals</span>(</p><p>self, name, tv_table, color=&#39;black&#39;, alpha=0.1, lw=3, dashes=[2, 2], **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Add line plots of individual volume vs time for all individuals in
a tumour volume table. These should be a logical group (eg treatment)
When used to produce html plots mouse over events will make the line
opaque (alpha=1.0) and label the line with the column name</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>name     -  The legend label for this group

tv_table -  a pandas data frame of volume measurements
            with individuals in columns and timepoints
            as rows.  Individuals are removed from study
            at the first NaN timepoint

color    -  the color to plot this data group
            Valid colors include matplotlib named colors
            html colors (eg &#39;#029386&#39;) or RGB tuples
            (eg (0.0078, 0.58, 0.53))

alpha    -  Percent transparency as a value between
            0.0 (transparent) and 1.0 (opaque)

lw       -  line width in points

dashes   -  A line dash pattern as an even length list
            of on off lengths in points

**kw     -  additional key word arguments are passed to
            matplotlib.axes.plot and can be any
            matplotlib.Line2D attributes
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.TumourVolumePlot.add_individuals', this);">Show source &equiv;</a></p>
  <div id="source-plot.TumourVolumePlot.add_individuals" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_individuals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                    <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                    <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add line plots of individual volume vs time for all individuals in</span>
<span class="sd">    a tumour volume table. These should be a logical group (eg treatment)</span>
<span class="sd">    When used to produce html plots mouse over events will make the line</span>
<span class="sd">    opaque (alpha=1.0) and label the line with the column name</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        name     -  The legend label for this group</span>
<span class="sd">    </span>
<span class="sd">        tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                    with individuals in columns and timepoints</span>
<span class="sd">                    as rows.  Individuals are removed from study</span>
<span class="sd">                    at the first NaN timepoint</span>
<span class="sd">    </span>
<span class="sd">        color    -  the color to plot this data group</span>
<span class="sd">                    Valid colors include matplotlib named colors</span>
<span class="sd">                    html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                    (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">    </span>
<span class="sd">        alpha    -  Percent transparency as a value between</span>
<span class="sd">                    0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">    </span>
<span class="sd">        lw       -  line width in points</span>
<span class="sd">    </span>
<span class="sd">        dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                    of on off lengths in points</span>
<span class="sd">    </span>
<span class="sd">        **kw     -  additional key word arguments are passed to</span>
<span class="sd">                    matplotlib.axes.plot and can be any</span>
<span class="sd">                    matplotlib.Line2D attributes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tv_table</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                                    <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">,</span>
                                    <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="n">plugins</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">HighlightLines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">name</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">name</span><span class="p">]):</span>
        <span class="n">plugins</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span>
                        <span class="n">plugins</span><span class="o">.</span><span class="n">LineLabelTooltip</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">tv_table</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.TumourVolumePlot.add_interval">
    <p>def <span class="ident">add_interval</span>(</p><p>self, name, tv_table, threshold=2, ci=0.95, color=&#39;black&#39;, alpha=0.2, lw=0, dashes=[], **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate the confidence interval of the mean and add to the 
plot as a shaded band around the mean. These individuals should be a
logical group (eg treatment).
Note that the value is the confidence interval for the standard
error of the mean and indicates the range the mean is expected
to lie within ci % of the time.
This should not be confused with the standard deviation of the data 
(the range within individual data is expected to lie) or the standard
error of the mean.
As most data is expected to have a small number of observations, the
95% confidence interval is calculated using a t distribution.
Results match R's t-test and Graphpad Prism's 95% CI</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>name     -  The legend label for this group

tv_table -  a pandas data frame of volume measurements
            with individuals in columns and timepoints
            as rows.  Individuals are removed from study
            at the first NaN timepoint

threshold - the minimum group size to plot a confidence
            interval for
            Default: 2

ci -        the confidence interval range to plot
            Default: 0.95

color    -  the color to plot this data group
            Valid colors include matplotlib named colors
            html colors (eg &#39;#029386&#39;) or RGB tuples
            (eg (0.0078, 0.58, 0.53))

alpha    -  Percent transparency as a value between
            0.0 (transparent) and 1.0 (opaque)

lw       -  line width in points

dashes   -  A line dash pattern as an even length list
            of on off lengths in points

**kw     -  additional key word arguments are passed to
            matplotlib.axes.fill_between
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.TumourVolumePlot.add_interval', this);">Show source &equiv;</a></p>
  <div id="source-plot.TumourVolumePlot.add_interval" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                    <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[],</span>
                    <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the confidence interval of the mean and add to the </span>
<span class="sd">    plot as a shaded band around the mean. These individuals should be a</span>
<span class="sd">    logical group (eg treatment).</span>
<span class="sd">    Note that the value is the confidence interval for the standard</span>
<span class="sd">    error of the mean and indicates the range the mean is expected</span>
<span class="sd">    to lie within ci % of the time.</span>
<span class="sd">    This should not be confused with the standard deviation of the data </span>
<span class="sd">    (the range within individual data is expected to lie) or the standard</span>
<span class="sd">    error of the mean.</span>
<span class="sd">    As most data is expected to have a small number of observations, the</span>
<span class="sd">    95% confidence interval is calculated using a t distribution.</span>
<span class="sd">    Results match R&#39;s t-test and Graphpad Prism&#39;s 95% CI</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        name     -  The legend label for this group</span>
<span class="sd">    </span>
<span class="sd">        tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                    with individuals in columns and timepoints</span>
<span class="sd">                    as rows.  Individuals are removed from study</span>
<span class="sd">                    at the first NaN timepoint</span>
<span class="sd">        </span>
<span class="sd">        threshold - the minimum group size to plot a confidence</span>
<span class="sd">                    interval for</span>
<span class="sd">                    Default: 2</span>
<span class="sd">    </span>
<span class="sd">        ci -        the confidence interval range to plot</span>
<span class="sd">                    Default: 0.95</span>
<span class="sd">    </span>
<span class="sd">        color    -  the color to plot this data group</span>
<span class="sd">                    Valid colors include matplotlib named colors</span>
<span class="sd">                    html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                    (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">    </span>
<span class="sd">        alpha    -  Percent transparency as a value between</span>
<span class="sd">                    0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">    </span>
<span class="sd">        lw       -  line width in points</span>
<span class="sd">    </span>
<span class="sd">        dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                    of on off lengths in points</span>
<span class="sd">    </span>
<span class="sd">        **kw     -  additional key word arguments are passed to</span>
<span class="sd">                    matplotlib.axes.fill_between</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_t_ci</span><span class="p">(</span><span class="n">tv_table</span><span class="p">[</span><span class="n">tv_table</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">],</span> <span class="n">ci</span><span class="o">=</span><span class="n">ci</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">intervals</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cis</span><span class="o">.</span><span class="n">index</span><span class="p">],</span>
                                               <span class="n">cis</span><span class="p">[</span><span class="s1">&#39;lower bound&#39;</span><span class="p">],</span>
                                               <span class="n">cis</span><span class="p">[</span><span class="s1">&#39;upper bound&#39;</span><span class="p">],</span>
                                               <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                                               <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">,</span>
                                               <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.TumourVolumePlot.add_legend">
    <p>def <span class="ident">add_legend</span>(</p><p>self, loc=&#39;best&#39;, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Create a legend from axis data after removing any existing
legends</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>loc   -   location of legend from: &#39;best&#39;,&#39;upper right&#39;,
          &#39;upper left&#39;,&#39;lower left&#39;,&#39;lower right&#39;,&#39;right&#39;,
          &#39;center left&#39;,&#39;center right&#39;,&#39;lower center&#39;,
          &#39;upper center&#39;,&#39;center&#39;
          Default: &#39;best&#39;

**kw  -   keyword arguments passed to matplotlib.axes.legend
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.TumourVolumePlot.add_legend', this);">Show source &equiv;</a></p>
  <div id="source-plot.TumourVolumePlot.add_legend" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a legend from axis data after removing any existing</span>
<span class="sd">    legends</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        loc   -   location of legend from: &#39;best&#39;,&#39;upper right&#39;,</span>
<span class="sd">                  &#39;upper left&#39;,&#39;lower left&#39;,&#39;lower right&#39;,&#39;right&#39;,</span>
<span class="sd">                  &#39;center left&#39;,&#39;center right&#39;,&#39;lower center&#39;,</span>
<span class="sd">                  &#39;upper center&#39;,&#39;center&#39;</span>
<span class="sd">                  Default: &#39;best&#39;</span>
<span class="sd">    </span>
<span class="sd">        **kw  -   keyword arguments passed to matplotlib.axes.legend</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">remove_legend</span><span class="p">()</span>
    <span class="n">patches</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">:</span>
        <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>
        <span class="n">patches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],[],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">patches</span><span class="p">,</span>
                  <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span>
                  <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.TumourVolumePlot.add_mean">
    <p>def <span class="ident">add_mean</span>(</p><p>self, name, tv_table, threshold=2, color=&#39;black&#39;, alpha=0.8, lw=4, dashes=[], **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate and add to the plot a line for the mean volume vs time 
for all individuals in a tumour volume table. These individuals 
should be a logical group (eg treatment)</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>name     -  The legend label for this group

tv_table -  a pandas data frame of volume measurements
            with individuals in columns and timepoints
            as rows.  Individuals are removed from study
            at the first NaN timepoint

threshold - the minimum group size to plot at a given
            time point.
            Default: 2

color    -  the color to plot this data group
            Valid colors include matplotlib named colors
            html colors (eg &#39;#029386&#39;) or RGB tuples
            (eg (0.0078, 0.58, 0.53))

alpha    -  Percent transparency as a value between
            0.0 (transparent) and 1.0 (opaque)

lw       -  line width in points

dashes   -  A line dash pattern as an even length list
            of on off lengths in points

**kw     -  additional key word arguments are passed to
            matplotlib.axes.plot and can be any
            matplotlib.Line2D attributes
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.TumourVolumePlot.add_mean', this);">Show source &equiv;</a></p>
  <div id="source-plot.TumourVolumePlot.add_mean" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                    <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[],</span>
                    <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate and add to the plot a line for the mean volume vs time </span>
<span class="sd">    for all individuals in a tumour volume table. These individuals </span>
<span class="sd">    should be a logical group (eg treatment)</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        name     -  The legend label for this group</span>
<span class="sd">    </span>
<span class="sd">        tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                    with individuals in columns and timepoints</span>
<span class="sd">                    as rows.  Individuals are removed from study</span>
<span class="sd">                    at the first NaN timepoint</span>
<span class="sd">    </span>
<span class="sd">        threshold - the minimum group size to plot at a given</span>
<span class="sd">                    time point.</span>
<span class="sd">                    Default: 2</span>
<span class="sd">    </span>
<span class="sd">        color    -  the color to plot this data group</span>
<span class="sd">                    Valid colors include matplotlib named colors</span>
<span class="sd">                    html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                    (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">    </span>
<span class="sd">        alpha    -  Percent transparency as a value between</span>
<span class="sd">                    0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">    </span>
<span class="sd">        lw       -  line width in points</span>
<span class="sd">    </span>
<span class="sd">        dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                    of on off lengths in points</span>
<span class="sd">    </span>
<span class="sd">        **kw     -  additional key word arguments are passed to</span>
<span class="sd">                    matplotlib.axes.plot and can be any</span>
<span class="sd">                    matplotlib.Line2D attributes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tv_table</span><span class="p">[</span><span class="n">tv_table</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                                    <span class="n">tv_table</span><span class="p">[</span><span class="n">tv_table</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                                    <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">,</span>
                                    <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.TumourVolumePlot.display">
    <p>def <span class="ident">display</span>(</p><p>self, legend=True, update=True, use_mpld3=True, hide_volume_labels=False, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Generate the figure and return an object for display
This function is for viewing figures in a Jupyter notebook</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>legend   -  boolean for displaying a legend
            Default: True

update   -  boolean for reapplying spine, tick, title and 
            axis limits to the graph
            Default: True

use_mpld3 - boolean for using mpld3 to produce interactive html
            Default: True

hide_volume_labels - boolean for hiding x axis volume labels
            Default: False

**kw      - additional keyword arguments are passed to mpld3.display
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.TumourVolumePlot.display', this);">Show source &equiv;</a></p>
  <div id="source-plot.TumourVolumePlot.display" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">use_mpld3</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">hide_volume_labels</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate the figure and return an object for display</span>
<span class="sd">    This function is for viewing figures in a Jupyter notebook</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        legend   -  boolean for displaying a legend</span>
<span class="sd">                    Default: True</span>
<span class="sd">    </span>
<span class="sd">        update   -  boolean for reapplying spine, tick, title and </span>
<span class="sd">                    axis limits to the graph</span>
<span class="sd">                    Default: True</span>
<span class="sd">    </span>
<span class="sd">        use_mpld3 - boolean for using mpld3 to produce interactive html</span>
<span class="sd">                    Default: True</span>
<span class="sd">    </span>
<span class="sd">        hide_volume_labels - boolean for hiding x axis volume labels</span>
<span class="sd">                    Default: False</span>
<span class="sd">    </span>
<span class="sd">        **kw      - additional keyword arguments are passed to mpld3.display</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">legend</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">legend</span> <span class="o">==</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_spines_and_ticks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_title_and_labels</span><span class="p">(</span><span class="n">hide_volume_labels</span> <span class="o">=</span> <span class="n">hide_volume_labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_limits</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">use_mpld3</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mpld3</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.TumourVolumePlot.remove_legend">
    <p>def <span class="ident">remove_legend</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Remove any existing matplotlib axis legend</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.TumourVolumePlot.remove_legend', this);">Show source &equiv;</a></p>
  <div id="source-plot.TumourVolumePlot.remove_legend" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove any existing matplotlib axis legend&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.TumourVolumePlot.save_html">
    <p>def <span class="ident">save_html</span>(</p><p>self, fileobj=None, legend=True, update=True, template_type=&#39;general&#39;, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Generate the figure as a html file</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>fileobj  -  a python file object
            Default: None (saved to a new file with the same
                           name as the parent object with .html)

legend   -  boolean for displaying a legend
            Default: True

update   -  boolean for reapplying spine, tick, title and 
            axis limits to the graph
            Default: True

template_type - string specifying the type of HTML template to use.
            Options from mpld3 are:
            &quot;simple&quot; suitable for simple html page with one figure.
            Will fail if require.js is available on the page.
            &quot;notebook&quot; assumes require.js and jquery are available.
            &quot;general&quot; works both in and out of the notebook,
            whether or not require.js and jquery are available
            Default: general

**kw      - additional keyword arguments are passed to mpld3.save_html
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.TumourVolumePlot.save_html', this);">Show source &equiv;</a></p>
  <div id="source-plot.TumourVolumePlot.save_html" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">template_type</span> <span class="o">=</span> <span class="s2">&quot;general&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate the figure as a html file</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        fileobj  -  a python file object</span>
<span class="sd">                    Default: None (saved to a new file with the same</span>
<span class="sd">                                   name as the parent object with .html)</span>
<span class="sd">    </span>
<span class="sd">        legend   -  boolean for displaying a legend</span>
<span class="sd">                    Default: True</span>
<span class="sd">    </span>
<span class="sd">        update   -  boolean for reapplying spine, tick, title and </span>
<span class="sd">                    axis limits to the graph</span>
<span class="sd">                    Default: True</span>
<span class="sd">    </span>
<span class="sd">        template_type - string specifying the type of HTML template to use.</span>
<span class="sd">                    Options from mpld3 are:</span>
<span class="sd">                    &quot;simple&quot; suitable for simple html page with one figure.</span>
<span class="sd">                    Will fail if require.js is available on the page.</span>
<span class="sd">                    &quot;notebook&quot; assumes require.js and jquery are available.</span>
<span class="sd">                    &quot;general&quot; works both in and out of the notebook,</span>
<span class="sd">                    whether or not require.js and jquery are available</span>
<span class="sd">                    Default: general</span>
<span class="sd">    </span>
<span class="sd">        **kw      - additional keyword arguments are passed to mpld3.save_html</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_legend</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span>
        <span class="n">fileobj</span><span class="o">=</span><span class="s1">&#39;{0}.html&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_spines_and_ticks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_title_and_labels</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_limits</span><span class="p">()</span>
    <span class="n">mpld3</span><span class="o">.</span><span class="n">save_html</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span>
                    <span class="n">fileobj</span><span class="o">=</span><span class="n">fileobj</span><span class="p">,</span>
                    <span class="n">template_type</span><span class="o">=</span><span class="n">template_type</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.TumourVolumePlot.save_pdf">
    <p>def <span class="ident">save_pdf</span>(</p><p>self, fileobj=None, legend=True, update=True, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Generate the figure as a pdf file</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>fileobj  -  a python file object
            Default: None (saved to a new file with the same
                           name as the parent object with .html)

legend   -  boolean for displaying a legend
            Default: True

update   -  boolean for reapplying spine, tick, title and 
            axis limits to the graph
            Default: True

**kw      - additional keyword arguments are passed to 
            matplotlib.PdfPages.savefig
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.TumourVolumePlot.save_pdf', this);">Show source &equiv;</a></p>
  <div id="source-plot.TumourVolumePlot.save_pdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate the figure as a pdf file</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        fileobj  -  a python file object</span>
<span class="sd">                    Default: None (saved to a new file with the same</span>
<span class="sd">                                   name as the parent object with .html)</span>
<span class="sd">    </span>
<span class="sd">        legend   -  boolean for displaying a legend</span>
<span class="sd">                    Default: True</span>
<span class="sd">    </span>
<span class="sd">        update   -  boolean for reapplying spine, tick, title and </span>
<span class="sd">                    axis limits to the graph</span>
<span class="sd">                    Default: True</span>
<span class="sd">    </span>
<span class="sd">        **kw      - additional keyword arguments are passed to </span>
<span class="sd">                    matplotlib.PdfPages.savefig</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_legend</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_spines_and_ticks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_title_and_labels</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_limits</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span>
        <span class="n">fileobj</span><span class="o">=</span><span class="s1">&#39;{0}.html&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">matplotlib.backends.backend_pdf</span> <span class="kn">import</span> <span class="n">PdfPages</span>
    <span class="k">with</span> <span class="n">PdfPages</span><span class="p">(</span><span class="n">fileobj</span><span class="p">)</span> <span class="k">as</span> <span class="n">pdf</span><span class="p">:</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.TumourVolumePlot.set_limits">
    <p>def <span class="ident">set_limits</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Apply the axis limits set by self.xlim and self.ylim
to the graph axis</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.TumourVolumePlot.set_limits', this);">Show source &equiv;</a></p>
  <div id="source-plot.TumourVolumePlot.set_limits" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Apply the axis limits set by self.xlim and self.ylim</span>
<span class="sd">    to the graph axis&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">)</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="k">else</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.TumourVolumePlot.set_spines_and_ticks">
    <p>def <span class="ident">set_spines_and_ticks</span>(</p><p>self, axes=None, remove_spines=[&#39;right&#39;, &#39;top&#39;], y_set_ticks=[&#39;left&#39;], x_set_ticks=[&#39;bottom&#39;])</p>
    </div>
    

    
  
    <div class="desc"><p>Set spines (the lines along the axis) and
tick locations for the plot</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>axes - the matplotlib.axis object to act on
       Default: None (interpreted as self.ax)

remove_spines - a list of spines to remove.
       Default: [&#39;right&#39;,&#39;top&#39;]

y_set_ticks - a list of locations of y axis ticks
       Default: [&#39;left&#39;]

x_set_ticks - a list of locations of x axis ticks
       Default: [&#39;bottom&#39;]
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.TumourVolumePlot.set_spines_and_ticks', this);">Show source &equiv;</a></p>
  <div id="source-plot.TumourVolumePlot.set_spines_and_ticks" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_spines_and_ticks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                        <span class="n">remove_spines</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="s1">&#39;top&#39;</span><span class="p">],</span>
                        <span class="n">y_set_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span>
                        <span class="n">x_set_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">],</span>
                        <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set spines (the lines along the axis) and</span>
<span class="sd">    tick locations for the plot</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">        </span>
<span class="sd">        axes - the matplotlib.axis object to act on</span>
<span class="sd">               Default: None (interpreted as self.ax)</span>
<span class="sd">        </span>
<span class="sd">        remove_spines - a list of spines to remove.</span>
<span class="sd">               Default: [&#39;right&#39;,&#39;top&#39;]</span>
<span class="sd">        </span>
<span class="sd">        y_set_ticks - a list of locations of y axis ticks</span>
<span class="sd">               Default: [&#39;left&#39;]</span>
<span class="sd">        </span>
<span class="sd">        x_set_ticks - a list of locations of x axis ticks</span>
<span class="sd">               Default: [&#39;bottom&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">axes</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">,]</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">remove_spines</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">y_set_ticks</span><span class="p">:</span>  
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">x_set_ticks</span><span class="p">:</span>  
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()):</span>
                <span class="n">item</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.TumourVolumePlot.set_title_and_labels">
    <p>def <span class="ident">set_title_and_labels</span>(</p><p>self, title=None, ylabel=None, xlabel=None, hide_volume_labels=False, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Set plot titles and axis labels</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>title   -   main plot title
            Default: None (uses self.title)

ylabel  -   y axis label
            Default: None (uses self.ylabel)

xlabel  -   x axis label
            Default: None (uses self.xlabel)

hide_volume_labels - for compatibility with dual plot
            Default: False
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.TumourVolumePlot.set_title_and_labels', this);">Show source &equiv;</a></p>
  <div id="source-plot.TumourVolumePlot.set_title_and_labels" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_title_and_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">hide_volume_labels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set plot titles and axis labels</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        title   -   main plot title</span>
<span class="sd">                    Default: None (uses self.title)</span>
<span class="sd">    </span>
<span class="sd">        ylabel  -   y axis label</span>
<span class="sd">                    Default: None (uses self.ylabel)</span>
<span class="sd">    </span>
<span class="sd">        xlabel  -   x axis label</span>
<span class="sd">                    Default: None (uses self.xlabel)</span>
<span class="sd">    </span>
<span class="sd">        hide_volume_labels - for compatibility with dual plot</span>
<span class="sd">                    Default: False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
    <span class="k">if</span> <span class="n">ylabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span>
    <span class="k">if</span> <span class="n">xlabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.TumourVolumePlot.shade_interval">
    <p>def <span class="ident">shade_interval</span>(</p><p>self, start, end, facecolor=&#39;lightgrey&#39;, alpha=0.2, lw=0, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Add rectangular fill the full height of the axis to indicate
a date range (eg for treatment).</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>start   -   the start point of the rectangle

end   -     the end point of the rectangle

facecolor - the fill color for the rectangular patches
            Valid colors include matplotlib named colors
            html colors (eg &#39;#029386&#39;) or RGB tuples
            (eg (0.0078, 0.58, 0.53))

alpha    -  Percent transparency as a value between
            0.0 (transparent) and 1.0 (opaque)
            Default: 0.2

lw     -   the width of the line bordering the patch in points
           Default: 0 (no line)

**kw  -   keyword arguments passed to matplotlib.patches.Rectangle
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.TumourVolumePlot.shade_interval', this);">Show source &equiv;</a></p>
  <div id="source-plot.TumourVolumePlot.shade_interval" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">shade_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add rectangular fill the full height of the axis to indicate</span>
<span class="sd">    a date range (eg for treatment).</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        start   -   the start point of the rectangle</span>
<span class="sd">    </span>
<span class="sd">        end   -     the end point of the rectangle</span>
<span class="sd">    </span>
<span class="sd">        facecolor - the fill color for the rectangular patches</span>
<span class="sd">                    Valid colors include matplotlib named colors</span>
<span class="sd">                    html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                    (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">    </span>
<span class="sd">        alpha    -  Percent transparency as a value between</span>
<span class="sd">                    0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">                    Default: 0.2</span>
<span class="sd">    </span>
<span class="sd">        lw     -   the width of the line bordering the patch in points</span>
<span class="sd">                   Default: 0 (no line)</span>
<span class="sd">    </span>
<span class="sd">        **kw  -   keyword arguments passed to matplotlib.patches.Rectangle</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">miny</span><span class="p">,</span><span class="n">maxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">get_data_interval</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">start</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">miny</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">end</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">maxy</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                                                    <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">))</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.TumourVolumePlot.show_treatment_days">
    <p>def <span class="ident">show_treatment_days</span>(</p><p>self, days, facecolor=&#39;lightgrey&#39;, lw=0, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Add rectangular patches on the x axis to indicate days
on which treatment occurred.</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>days   -   an integer list of days eg [1,3,5]

facecolor - the fill color for the rectangular patches
            Valid colors include matplotlib named colors
            html colors (eg &#39;#029386&#39;) or RGB tuples
            (eg (0.0078, 0.58, 0.53))

lw     -   the width of the line bordering the patch in points
           Default: 0 (no line)

**kw  -   keyword arguments passed to matplotlib.patches.Rectangle
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.TumourVolumePlot.show_treatment_days', this);">Show source &equiv;</a></p>
  <div id="source-plot.TumourVolumePlot.show_treatment_days" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">show_treatment_days</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add rectangular patches on the x axis to indicate days</span>
<span class="sd">    on which treatment occurred.</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        days   -   an integer list of days eg [1,3,5]</span>
<span class="sd">    </span>
<span class="sd">        facecolor - the fill color for the rectangular patches</span>
<span class="sd">                    Valid colors include matplotlib named colors</span>
<span class="sd">                    html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                    (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">    </span>
<span class="sd">        lw     -   the width of the line bordering the patch in points</span>
<span class="sd">                   Default: 0 (no line)</span>
<span class="sd">    </span>
<span class="sd">        **kw  -   keyword arguments passed to matplotlib.patches.Rectangle</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">days</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">day</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">))</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="plot.TumourVolumePlot.fontsize" class="name">var <span class="ident">fontsize</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.TumourVolumePlot.intervals" class="name">var <span class="ident">intervals</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.TumourVolumePlot.lines" class="name">var <span class="ident">lines</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.TumourVolumePlot.means" class="name">var <span class="ident">means</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.TumourVolumePlot.title" class="name">var <span class="ident">title</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.TumourVolumePlot.xlabel" class="name">var <span class="ident">xlabel</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.TumourVolumePlot.xlim" class="name">var <span class="ident">xlim</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.TumourVolumePlot.ylabel" class="name">var <span class="ident">ylabel</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.TumourVolumePlot.ylim" class="name">var <span class="ident">ylim</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="plot.VolumeSurvivalPlot" class="name">class <span class="ident">VolumeSurvivalPlot</span></p>
      
  
    <div class="desc"><p>Initiate a new dual panel Tumour Volume and Survival plot object</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>km_size  -  The relative size of the survival plot
            Default: 0.5 (ie half or 1/3 total plot area)

vertical -  Stack the Tumour Volume plot over the survival plot
            with a shared x axis (days) so events co occur.
            Default: True

**kw - keyword arguments are passed to
       matplotlib.pyplot.subplots
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">VolumeSurvivalPlot</span><span class="p">(</span><span class="n">TumourVolumePlot</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initiate a new dual panel Tumour Volume and Survival plot object</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        km_size  -  The relative size of the survival plot</span>
<span class="sd">                    Default: 0.5 (ie half or 1/3 total plot area)</span>
<span class="sd">    </span>
<span class="sd">        vertical -  Stack the Tumour Volume plot over the survival plot</span>
<span class="sd">                    with a shared x axis (days) so events co occur.</span>
<span class="sd">                    Default: True</span>
<span class="sd">    </span>
<span class="sd">        **kw - keyword arguments are passed to</span>
<span class="sd">               matplotlib.pyplot.subplots</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">km_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">vertical</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;height_ratios&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="n">km_size</span><span class="p">]},</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width_ratios&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="n">km_size</span><span class="p">]},</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">means</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kmfs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intervals</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Untitled&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;Tumour Volume mm$^{3}$&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Days&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_title</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ylabel</span> <span class="o">=</span> <span class="s1">&#39;Survival&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_xlabel</span> <span class="o">=</span> <span class="s1">&#39;Days&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_yticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ci_show</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_show_censors</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertical</span> <span class="o">=</span> <span class="n">vertical</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volume_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">remove_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove any existing matplotlib axis legend&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">legend_</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">add_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                        <span class="n">endpoint</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span>
                        <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                        <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[],</span>
                        <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate and add to the plot a line for the mean volume vs time </span>
<span class="sd">        for all individuals in a tumour volume table. These individuals </span>
<span class="sd">        should be a logical group (eg treatment)</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            name     -  The legend label for this group</span>
<span class="sd">        </span>
<span class="sd">            tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                        with individuals in columns and timepoints</span>
<span class="sd">                        as rows.  Individuals are removed from study</span>
<span class="sd">                        at the first NaN timepoint</span>
<span class="sd">        </span>
<span class="sd">            endpoint -  the volume at which the endpoint is reached</span>
<span class="sd">                        Default: 700</span>
<span class="sd">        </span>
<span class="sd">            threshold - the minimum group size to plot at a given</span>
<span class="sd">                        time point.</span>
<span class="sd">                        Default: 2</span>
<span class="sd">        </span>
<span class="sd">            color    -  the color to plot this data group</span>
<span class="sd">                        Valid colors include matplotlib named colors</span>
<span class="sd">                        html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                        (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">        </span>
<span class="sd">            alpha    -  Percent transparency as a value between</span>
<span class="sd">                        0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">        </span>
<span class="sd">            lw       -  line width in points</span>
<span class="sd">                        Default: 4</span>
<span class="sd">        </span>
<span class="sd">            dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                        of on off lengths in points</span>
<span class="sd">        </span>
<span class="sd">            **kw     -  additional key word arguments are passed to</span>
<span class="sd">                        matplotlib.axes.plot and </span>
<span class="sd">                        lifelines.kmf.plot and can be any</span>
<span class="sd">                        matplotlib.Line2D attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">VolumeSurvivalPlot</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_mean</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="o">=</span><span class="n">tv_table</span><span class="p">,</span>
                        <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                        <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="n">dashes</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volume_data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tv_table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_kmf</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                     <span class="n">endpoint</span> <span class="o">=</span> <span class="n">endpoint</span><span class="p">,</span>
                     <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                     <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="n">dashes</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">add_kmf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                        <span class="n">endpoint</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                        <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[],</span>
                        <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate and add a Kaplan Meier curve to the second panel</span>
<span class="sd">        of the plot for all individuals in a tumour volume table.</span>
<span class="sd">        These individuals should be a logical group (eg treatment)</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            name     -  The legend label for this group</span>
<span class="sd">        </span>
<span class="sd">            tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                        with individuals in columns and timepoints</span>
<span class="sd">                        as rows.  Individuals are removed from study</span>
<span class="sd">                        at the first NaN timepoint</span>

<span class="sd">            endpoint -  the volume at which the endpoint is reached</span>
<span class="sd">                        Default: 700</span>
<span class="sd">        </span>
<span class="sd">            color    -  the color to plot this data group</span>
<span class="sd">                        Valid colors include matplotlib named colors</span>
<span class="sd">                        html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                        (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">        </span>
<span class="sd">            alpha    -  Percent transparency as a value between</span>
<span class="sd">                        0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">        </span>
<span class="sd">            lw       -  line width in points</span>
<span class="sd">                        Default: 4</span>
<span class="sd">        </span>
<span class="sd">            dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                        of on off lengths in points</span>
<span class="sd">        </span>
<span class="sd">            **kw     -  additional key word arguments are passed to</span>
<span class="sd">                        lifelines.kmf.plot and can be any</span>
<span class="sd">                        matplotlib.Line2D attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kmfs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_km</span><span class="p">(</span><span class="n">tv_table</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">endpoint</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kmfs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                     <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="n">dashes</span><span class="p">,</span>
                     <span class="n">show_censors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_show_censors</span><span class="p">,</span>
                     <span class="n">ci_show</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_ci_show</span><span class="p">,</span>
                     <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">set_title_and_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">km_title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">km_ylabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">km_xlabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">hide_volume_labels</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set plot titles and axis labels</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        </span>
<span class="sd">            title   -   main plot title</span>
<span class="sd">                        Default: None (uses self.title)</span>
<span class="sd">        </span>
<span class="sd">            ylabel  -   y axis label</span>
<span class="sd">                        Default: None (uses self.ylabel)</span>
<span class="sd">        </span>
<span class="sd">            xlabel  -   x axis label</span>
<span class="sd">                        Default: None (uses self.xlabel)</span>
<span class="sd">        </span>
<span class="sd">            kmtitle   - Kaplan Meier plot label</span>
<span class="sd">                        Default: None (uses self.km_title)</span>
<span class="sd">        </span>
<span class="sd">            ylabel  -   y axis label</span>
<span class="sd">                        Default: None (uses self.km_ylabel)</span>
<span class="sd">        </span>
<span class="sd">            xlabel  -   x axis label</span>
<span class="sd">                        Default: None (uses self.km_xlabel)</span>
<span class="sd">        </span>
<span class="sd">            hide_volume_labels - do not display x axis label</span>
<span class="sd">                        between volume plot and Kaplan-Meier</span>
<span class="sd">                        Default: True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
        <span class="k">if</span> <span class="n">ylabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span>
        <span class="k">if</span> <span class="n">xlabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">xlabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span>
        <span class="k">if</span> <span class="n">km_title</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">km_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_title</span>
        <span class="k">if</span> <span class="n">km_ylabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">km_ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_ylabel</span>
        <span class="k">if</span> <span class="n">km_xlabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">km_xlabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_xlabel</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span> <span class="ow">and</span> <span class="ow">not</span> <span class="s1">&#39;fontsize&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
            <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">hide_volume_labels</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">km_title</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">km_ylabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">km_xlabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">set_spines_and_ticks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                            <span class="n">remove_spines</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="s1">&#39;top&#39;</span><span class="p">],</span>
                            <span class="n">y_set_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span>
                            <span class="n">x_set_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">],</span>
                            <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set spines (the lines along the axis) and</span>
<span class="sd">        tick locations for the plot</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">            </span>
<span class="sd">            axes - the matplotlib.axis object to act on</span>
<span class="sd">                   Default: None</span>
<span class="sd">                   (interpreted as self.ax and self.km_ax)</span>
<span class="sd">            </span>
<span class="sd">            remove_spines - a list of spines to remove.</span>
<span class="sd">                   Default: [&#39;right&#39;,&#39;top&#39;]</span>
<span class="sd">            </span>
<span class="sd">            y_set_ticks - a list of locations of y axis ticks</span>
<span class="sd">                   Default: [&#39;left&#39;]</span>
<span class="sd">            </span>
<span class="sd">            x_set_ticks - a list of locations of x axis ticks</span>
<span class="sd">                   Default: [&#39;bottom&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">]</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">VolumeSurvivalPlot</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set_spines_and_ticks</span><span class="p">(</span><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">,</span>
                                                            <span class="n">remove_spines</span> <span class="o">=</span> <span class="n">remove_spines</span><span class="p">,</span>
                                                            <span class="n">y_set_ticks</span> <span class="o">=</span> <span class="n">y_set_ticks</span><span class="p">,</span>
                                                            <span class="n">x_set_ticks</span> <span class="o">=</span> <span class="n">x_set_ticks</span><span class="p">,)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">km_yticks</span><span class="p">)</span>
        
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">set_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply the axis limits set by self.xlim and self.ylim</span>
<span class="sd">        to the graph axes.  The Kaplan-Meier y axis will remain</span>
<span class="sd">        [0,1.02]&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">)</span>
            <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="k">else</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.02</span><span class="p">])</span> <span class="c1">#set &gt;1 so lines retain full width</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.02</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">logrank_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">treatment_a</span><span class="p">,</span> <span class="n">treatment_b</span><span class="p">,</span> <span class="n">t1error</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate a log rank test (Mantel-Cox) statistic between two treatments</span>
<span class="sd">        Calls lifelines.statistics.logrank_test for calculation.</span>

<span class="sd">        Arguments:</span>

<span class="sd">            treatment_a     -  The legend label for this group as used</span>
<span class="sd">                               with add_mean.</span>

<span class="sd">            treatment_b     -  The legend label for this group as used</span>
<span class="sd">                               with add_mean.</span>

<span class="sd">            t1error         -  probability of a type 1 error (alpha)</span>
<span class="sd">                               Default: 0.05</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume_data</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;you need to add data with .add_mean() before using logrank_test&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>
        <span class="n">survival_a</span> <span class="o">=</span> <span class="n">volume_to_survival</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume_data</span><span class="p">[</span><span class="n">treatment_a</span><span class="p">],</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="p">)</span>
        <span class="n">survival_b</span> <span class="o">=</span> <span class="n">volume_to_survival</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume_data</span><span class="p">[</span><span class="n">treatment_b</span><span class="p">],</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">logrank_test</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">survival_a</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]),</span>
                                                   <span class="nb">list</span><span class="p">(</span><span class="n">survival_b</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]),</span>
                                                   <span class="nb">list</span><span class="p">(</span><span class="n">survival_a</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">]),</span>
                                                   <span class="nb">list</span><span class="p">(</span><span class="n">survival_b</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">]),</span>
                                                   <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">t1error</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">print_summary</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span>
    
    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">use_mpld3</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">hide_volume_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Display the dual tumour volume and Kaplan Meier plot</span>
<span class="sd">        KNOWN BUG - mpld3 does not correctly display the step plot in version &lt; 0.3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">VolumeSurvivalPlot</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span>
                                                <span class="n">use_mpld3</span><span class="o">=</span><span class="n">use_mpld3</span><span class="p">,</span>
                                                <span class="n">update</span><span class="o">=</span><span class="n">update</span><span class="p">,</span>
                                                <span class="n">hide_volume_labels</span> <span class="o">=</span> <span class="n">hide_volume_labels</span><span class="p">,</span>
                                                <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_mpld3</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#plot.VolumeSurvivalPlot">VolumeSurvivalPlot</a></li>
          <li><a href="#plot.TumourVolumePlot">TumourVolumePlot</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, km_size=0.5, vertical=True, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Initiate a new tumour TumourVolumePlot object</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>**kw - keyword arguments are passed to
       matplotlib.pyplot.subplots
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.__init__', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">km_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">vertical</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;height_ratios&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="n">km_size</span><span class="p">]},</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width_ratios&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="n">km_size</span><span class="p">]},</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">means</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kmfs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">intervals</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Untitled&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;Tumour Volume mm$^{3}$&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Days&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">km_title</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">km_ylabel</span> <span class="o">=</span> <span class="s1">&#39;Survival&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">km_xlabel</span> <span class="o">=</span> <span class="s1">&#39;Days&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">km_yticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">km_ci_show</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">km_show_censors</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vertical</span> <span class="o">=</span> <span class="n">vertical</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">volume_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.add_individuals">
    <p>def <span class="ident">add_individuals</span>(</p><p>self, name, tv_table, color=&#39;black&#39;, alpha=0.1, lw=3, dashes=[2, 2], **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Add line plots of individual volume vs time for all individuals in
a tumour volume table. These should be a logical group (eg treatment)
When used to produce html plots mouse over events will make the line
opaque (alpha=1.0) and label the line with the column name</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>name     -  The legend label for this group

tv_table -  a pandas data frame of volume measurements
            with individuals in columns and timepoints
            as rows.  Individuals are removed from study
            at the first NaN timepoint

color    -  the color to plot this data group
            Valid colors include matplotlib named colors
            html colors (eg &#39;#029386&#39;) or RGB tuples
            (eg (0.0078, 0.58, 0.53))

alpha    -  Percent transparency as a value between
            0.0 (transparent) and 1.0 (opaque)

lw       -  line width in points

dashes   -  A line dash pattern as an even length list
            of on off lengths in points

**kw     -  additional key word arguments are passed to
            matplotlib.axes.plot and can be any
            matplotlib.Line2D attributes
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.add_individuals', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.add_individuals" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_individuals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                    <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                    <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add line plots of individual volume vs time for all individuals in</span>
<span class="sd">    a tumour volume table. These should be a logical group (eg treatment)</span>
<span class="sd">    When used to produce html plots mouse over events will make the line</span>
<span class="sd">    opaque (alpha=1.0) and label the line with the column name</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        name     -  The legend label for this group</span>
<span class="sd">    </span>
<span class="sd">        tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                    with individuals in columns and timepoints</span>
<span class="sd">                    as rows.  Individuals are removed from study</span>
<span class="sd">                    at the first NaN timepoint</span>
<span class="sd">    </span>
<span class="sd">        color    -  the color to plot this data group</span>
<span class="sd">                    Valid colors include matplotlib named colors</span>
<span class="sd">                    html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                    (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">    </span>
<span class="sd">        alpha    -  Percent transparency as a value between</span>
<span class="sd">                    0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">    </span>
<span class="sd">        lw       -  line width in points</span>
<span class="sd">    </span>
<span class="sd">        dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                    of on off lengths in points</span>
<span class="sd">    </span>
<span class="sd">        **kw     -  additional key word arguments are passed to</span>
<span class="sd">                    matplotlib.axes.plot and can be any</span>
<span class="sd">                    matplotlib.Line2D attributes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tv_table</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                                    <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">,</span>
                                    <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="n">plugins</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">HighlightLines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">name</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">name</span><span class="p">]):</span>
        <span class="n">plugins</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span>
                        <span class="n">plugins</span><span class="o">.</span><span class="n">LineLabelTooltip</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">tv_table</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.add_interval">
    <p>def <span class="ident">add_interval</span>(</p><p>self, name, tv_table, threshold=2, ci=0.95, color=&#39;black&#39;, alpha=0.2, lw=0, dashes=[], **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate the confidence interval of the mean and add to the 
plot as a shaded band around the mean. These individuals should be a
logical group (eg treatment).
Note that the value is the confidence interval for the standard
error of the mean and indicates the range the mean is expected
to lie within ci % of the time.
This should not be confused with the standard deviation of the data 
(the range within individual data is expected to lie) or the standard
error of the mean.
As most data is expected to have a small number of observations, the
95% confidence interval is calculated using a t distribution.
Results match R's t-test and Graphpad Prism's 95% CI</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>name     -  The legend label for this group

tv_table -  a pandas data frame of volume measurements
            with individuals in columns and timepoints
            as rows.  Individuals are removed from study
            at the first NaN timepoint

threshold - the minimum group size to plot a confidence
            interval for
            Default: 2

ci -        the confidence interval range to plot
            Default: 0.95

color    -  the color to plot this data group
            Valid colors include matplotlib named colors
            html colors (eg &#39;#029386&#39;) or RGB tuples
            (eg (0.0078, 0.58, 0.53))

alpha    -  Percent transparency as a value between
            0.0 (transparent) and 1.0 (opaque)

lw       -  line width in points

dashes   -  A line dash pattern as an even length list
            of on off lengths in points

**kw     -  additional key word arguments are passed to
            matplotlib.axes.fill_between
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.add_interval', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.add_interval" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                    <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[],</span>
                    <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the confidence interval of the mean and add to the </span>
<span class="sd">    plot as a shaded band around the mean. These individuals should be a</span>
<span class="sd">    logical group (eg treatment).</span>
<span class="sd">    Note that the value is the confidence interval for the standard</span>
<span class="sd">    error of the mean and indicates the range the mean is expected</span>
<span class="sd">    to lie within ci % of the time.</span>
<span class="sd">    This should not be confused with the standard deviation of the data </span>
<span class="sd">    (the range within individual data is expected to lie) or the standard</span>
<span class="sd">    error of the mean.</span>
<span class="sd">    As most data is expected to have a small number of observations, the</span>
<span class="sd">    95% confidence interval is calculated using a t distribution.</span>
<span class="sd">    Results match R&#39;s t-test and Graphpad Prism&#39;s 95% CI</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        name     -  The legend label for this group</span>
<span class="sd">    </span>
<span class="sd">        tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                    with individuals in columns and timepoints</span>
<span class="sd">                    as rows.  Individuals are removed from study</span>
<span class="sd">                    at the first NaN timepoint</span>
<span class="sd">        </span>
<span class="sd">        threshold - the minimum group size to plot a confidence</span>
<span class="sd">                    interval for</span>
<span class="sd">                    Default: 2</span>
<span class="sd">    </span>
<span class="sd">        ci -        the confidence interval range to plot</span>
<span class="sd">                    Default: 0.95</span>
<span class="sd">    </span>
<span class="sd">        color    -  the color to plot this data group</span>
<span class="sd">                    Valid colors include matplotlib named colors</span>
<span class="sd">                    html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                    (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">    </span>
<span class="sd">        alpha    -  Percent transparency as a value between</span>
<span class="sd">                    0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">    </span>
<span class="sd">        lw       -  line width in points</span>
<span class="sd">    </span>
<span class="sd">        dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                    of on off lengths in points</span>
<span class="sd">    </span>
<span class="sd">        **kw     -  additional key word arguments are passed to</span>
<span class="sd">                    matplotlib.axes.fill_between</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_t_ci</span><span class="p">(</span><span class="n">tv_table</span><span class="p">[</span><span class="n">tv_table</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">],</span> <span class="n">ci</span><span class="o">=</span><span class="n">ci</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">intervals</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cis</span><span class="o">.</span><span class="n">index</span><span class="p">],</span>
                                               <span class="n">cis</span><span class="p">[</span><span class="s1">&#39;lower bound&#39;</span><span class="p">],</span>
                                               <span class="n">cis</span><span class="p">[</span><span class="s1">&#39;upper bound&#39;</span><span class="p">],</span>
                                               <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                                               <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="n">dashes</span><span class="p">,</span>
                                               <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.add_kmf">
    <p>def <span class="ident">add_kmf</span>(</p><p>self, name, tv_table, endpoint=700, color=&#39;black&#39;, alpha=0.8, lw=4, dashes=[], **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate and add a Kaplan Meier curve to the second panel
of the plot for all individuals in a tumour volume table.
These individuals should be a logical group (eg treatment)</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>name     -  The legend label for this group

tv_table -  a pandas data frame of volume measurements
            with individuals in columns and timepoints
            as rows.  Individuals are removed from study
            at the first NaN timepoint

endpoint -  the volume at which the endpoint is reached
            Default: 700

color    -  the color to plot this data group
            Valid colors include matplotlib named colors
            html colors (eg &#39;#029386&#39;) or RGB tuples
            (eg (0.0078, 0.58, 0.53))

alpha    -  Percent transparency as a value between
            0.0 (transparent) and 1.0 (opaque)

lw       -  line width in points
            Default: 4

dashes   -  A line dash pattern as an even length list
            of on off lengths in points

**kw     -  additional key word arguments are passed to
            lifelines.kmf.plot and can be any
            matplotlib.Line2D attributes
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.add_kmf', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.add_kmf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_kmf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                    <span class="n">endpoint</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                    <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[],</span>
                    <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate and add a Kaplan Meier curve to the second panel</span>
<span class="sd">    of the plot for all individuals in a tumour volume table.</span>
<span class="sd">    These individuals should be a logical group (eg treatment)</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        name     -  The legend label for this group</span>
<span class="sd">    </span>
<span class="sd">        tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                    with individuals in columns and timepoints</span>
<span class="sd">                    as rows.  Individuals are removed from study</span>
<span class="sd">                    at the first NaN timepoint</span>
<span class="sd">        endpoint -  the volume at which the endpoint is reached</span>
<span class="sd">                    Default: 700</span>
<span class="sd">    </span>
<span class="sd">        color    -  the color to plot this data group</span>
<span class="sd">                    Valid colors include matplotlib named colors</span>
<span class="sd">                    html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                    (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">    </span>
<span class="sd">        alpha    -  Percent transparency as a value between</span>
<span class="sd">                    0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">    </span>
<span class="sd">        lw       -  line width in points</span>
<span class="sd">                    Default: 4</span>
<span class="sd">    </span>
<span class="sd">        dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                    of on off lengths in points</span>
<span class="sd">    </span>
<span class="sd">        **kw     -  additional key word arguments are passed to</span>
<span class="sd">                    lifelines.kmf.plot and can be any</span>
<span class="sd">                    matplotlib.Line2D attributes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kmfs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_km</span><span class="p">(</span><span class="n">tv_table</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">endpoint</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kmfs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                 <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="n">dashes</span><span class="p">,</span>
                 <span class="n">show_censors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_show_censors</span><span class="p">,</span>
                 <span class="n">ci_show</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_ci_show</span><span class="p">,</span>
                 <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.add_legend">
    <p>def <span class="ident">add_legend</span>(</p><p>self, loc=&#39;best&#39;, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Create a legend from axis data after removing any existing
legends</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>loc   -   location of legend from: &#39;best&#39;,&#39;upper right&#39;,
          &#39;upper left&#39;,&#39;lower left&#39;,&#39;lower right&#39;,&#39;right&#39;,
          &#39;center left&#39;,&#39;center right&#39;,&#39;lower center&#39;,
          &#39;upper center&#39;,&#39;center&#39;
          Default: &#39;best&#39;

**kw  -   keyword arguments passed to matplotlib.axes.legend
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.add_legend', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.add_legend" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a legend from axis data after removing any existing</span>
<span class="sd">    legends</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        loc   -   location of legend from: &#39;best&#39;,&#39;upper right&#39;,</span>
<span class="sd">                  &#39;upper left&#39;,&#39;lower left&#39;,&#39;lower right&#39;,&#39;right&#39;,</span>
<span class="sd">                  &#39;center left&#39;,&#39;center right&#39;,&#39;lower center&#39;,</span>
<span class="sd">                  &#39;upper center&#39;,&#39;center&#39;</span>
<span class="sd">                  Default: &#39;best&#39;</span>
<span class="sd">    </span>
<span class="sd">        **kw  -   keyword arguments passed to matplotlib.axes.legend</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">remove_legend</span><span class="p">()</span>
    <span class="n">patches</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">:</span>
        <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>
        <span class="n">patches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],[],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">patches</span><span class="p">,</span>
                  <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span>
                  <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.add_mean">
    <p>def <span class="ident">add_mean</span>(</p><p>self, name, tv_table, endpoint=700, threshold=2, color=&#39;black&#39;, alpha=0.8, lw=4, dashes=[], **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate and add to the plot a line for the mean volume vs time 
for all individuals in a tumour volume table. These individuals 
should be a logical group (eg treatment)</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>name     -  The legend label for this group

tv_table -  a pandas data frame of volume measurements
            with individuals in columns and timepoints
            as rows.  Individuals are removed from study
            at the first NaN timepoint

endpoint -  the volume at which the endpoint is reached
            Default: 700

threshold - the minimum group size to plot at a given
            time point.
            Default: 2

color    -  the color to plot this data group
            Valid colors include matplotlib named colors
            html colors (eg &#39;#029386&#39;) or RGB tuples
            (eg (0.0078, 0.58, 0.53))

alpha    -  Percent transparency as a value between
            0.0 (transparent) and 1.0 (opaque)

lw       -  line width in points
            Default: 4

dashes   -  A line dash pattern as an even length list
            of on off lengths in points

**kw     -  additional key word arguments are passed to
            matplotlib.axes.plot and 
            lifelines.kmf.plot and can be any
            matplotlib.Line2D attributes
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.add_mean', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.add_mean" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                    <span class="n">endpoint</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span>
                    <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                    <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="p">[],</span>
                    <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate and add to the plot a line for the mean volume vs time </span>
<span class="sd">    for all individuals in a tumour volume table. These individuals </span>
<span class="sd">    should be a logical group (eg treatment)</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        name     -  The legend label for this group</span>
<span class="sd">    </span>
<span class="sd">        tv_table -  a pandas data frame of volume measurements</span>
<span class="sd">                    with individuals in columns and timepoints</span>
<span class="sd">                    as rows.  Individuals are removed from study</span>
<span class="sd">                    at the first NaN timepoint</span>
<span class="sd">    </span>
<span class="sd">        endpoint -  the volume at which the endpoint is reached</span>
<span class="sd">                    Default: 700</span>
<span class="sd">    </span>
<span class="sd">        threshold - the minimum group size to plot at a given</span>
<span class="sd">                    time point.</span>
<span class="sd">                    Default: 2</span>
<span class="sd">    </span>
<span class="sd">        color    -  the color to plot this data group</span>
<span class="sd">                    Valid colors include matplotlib named colors</span>
<span class="sd">                    html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                    (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">    </span>
<span class="sd">        alpha    -  Percent transparency as a value between</span>
<span class="sd">                    0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">    </span>
<span class="sd">        lw       -  line width in points</span>
<span class="sd">                    Default: 4</span>
<span class="sd">    </span>
<span class="sd">        dashes   -  A line dash pattern as an even length list</span>
<span class="sd">                    of on off lengths in points</span>
<span class="sd">    </span>
<span class="sd">        **kw     -  additional key word arguments are passed to</span>
<span class="sd">                    matplotlib.axes.plot and </span>
<span class="sd">                    lifelines.kmf.plot and can be any</span>
<span class="sd">                    matplotlib.Line2D attributes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">VolumeSurvivalPlot</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_mean</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="o">=</span><span class="n">tv_table</span><span class="p">,</span>
                    <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                    <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="n">dashes</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">volume_data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tv_table</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_kmf</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">tv_table</span><span class="p">,</span>
                 <span class="n">endpoint</span> <span class="o">=</span> <span class="n">endpoint</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                 <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">dashes</span> <span class="o">=</span> <span class="n">dashes</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.display">
    <p>def <span class="ident">display</span>(</p><p>self, legend=True, use_mpld3=True, update=True, hide_volume_labels=True, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Display the dual tumour volume and Kaplan Meier plot
KNOWN BUG - mpld3 does not correctly display the step plot in version &lt; 0.3</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.display', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.display" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">use_mpld3</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">hide_volume_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Display the dual tumour volume and Kaplan Meier plot</span>
<span class="sd">    KNOWN BUG - mpld3 does not correctly display the step plot in version &lt; 0.3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">VolumeSurvivalPlot</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span>
                                            <span class="n">use_mpld3</span><span class="o">=</span><span class="n">use_mpld3</span><span class="p">,</span>
                                            <span class="n">update</span><span class="o">=</span><span class="n">update</span><span class="p">,</span>
                                            <span class="n">hide_volume_labels</span> <span class="o">=</span> <span class="n">hide_volume_labels</span><span class="p">,</span>
                                            <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">use_mpld3</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.logrank_test">
    <p>def <span class="ident">logrank_test</span>(</p><p>self, treatment_a, treatment_b, t1error=0.05)</p>
    </div>
    

    
  
    <div class="desc"><p>Calculate a log rank test (Mantel-Cox) statistic between two treatments
Calls lifelines.statistics.logrank_test for calculation.</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>treatment_a     -  The legend label for this group as used
                   with add_mean.

treatment_b     -  The legend label for this group as used
                   with add_mean.

t1error         -  probability of a type 1 error (alpha)
                   Default: 0.05
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.logrank_test', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.logrank_test" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">logrank_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">treatment_a</span><span class="p">,</span> <span class="n">treatment_b</span><span class="p">,</span> <span class="n">t1error</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate a log rank test (Mantel-Cox) statistic between two treatments</span>
<span class="sd">    Calls lifelines.statistics.logrank_test for calculation.</span>
<span class="sd">    Arguments:</span>
<span class="sd">        treatment_a     -  The legend label for this group as used</span>
<span class="sd">                           with add_mean.</span>
<span class="sd">        treatment_b     -  The legend label for this group as used</span>
<span class="sd">                           with add_mean.</span>
<span class="sd">        t1error         -  probability of a type 1 error (alpha)</span>
<span class="sd">                           Default: 0.05</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume_data</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;you need to add data with .add_mean() before using logrank_test&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="n">survival_a</span> <span class="o">=</span> <span class="n">volume_to_survival</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume_data</span><span class="p">[</span><span class="n">treatment_a</span><span class="p">],</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="p">)</span>
    <span class="n">survival_b</span> <span class="o">=</span> <span class="n">volume_to_survival</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume_data</span><span class="p">[</span><span class="n">treatment_b</span><span class="p">],</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">logrank_test</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">survival_a</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]),</span>
                                               <span class="nb">list</span><span class="p">(</span><span class="n">survival_b</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]),</span>
                                               <span class="nb">list</span><span class="p">(</span><span class="n">survival_a</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">]),</span>
                                               <span class="nb">list</span><span class="p">(</span><span class="n">survival_b</span><span class="p">[</span><span class="s1">&#39;Observed&#39;</span><span class="p">]),</span>
                                               <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">t1error</span><span class="p">)</span>
    <span class="n">result</span><span class="o">.</span><span class="n">print_summary</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.remove_legend">
    <p>def <span class="ident">remove_legend</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Remove any existing matplotlib axis legend</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.remove_legend', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.remove_legend" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove any existing matplotlib axis legend&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">legend_</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.save_html">
    <p>def <span class="ident">save_html</span>(</p><p>self, fileobj=None, legend=True, update=True, template_type=&#39;general&#39;, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Generate the figure as a html file</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>fileobj  -  a python file object
            Default: None (saved to a new file with the same
                           name as the parent object with .html)

legend   -  boolean for displaying a legend
            Default: True

update   -  boolean for reapplying spine, tick, title and 
            axis limits to the graph
            Default: True

template_type - string specifying the type of HTML template to use.
            Options from mpld3 are:
            &quot;simple&quot; suitable for simple html page with one figure.
            Will fail if require.js is available on the page.
            &quot;notebook&quot; assumes require.js and jquery are available.
            &quot;general&quot; works both in and out of the notebook,
            whether or not require.js and jquery are available
            Default: general

**kw      - additional keyword arguments are passed to mpld3.save_html
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.save_html', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.save_html" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">template_type</span> <span class="o">=</span> <span class="s2">&quot;general&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate the figure as a html file</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        fileobj  -  a python file object</span>
<span class="sd">                    Default: None (saved to a new file with the same</span>
<span class="sd">                                   name as the parent object with .html)</span>
<span class="sd">    </span>
<span class="sd">        legend   -  boolean for displaying a legend</span>
<span class="sd">                    Default: True</span>
<span class="sd">    </span>
<span class="sd">        update   -  boolean for reapplying spine, tick, title and </span>
<span class="sd">                    axis limits to the graph</span>
<span class="sd">                    Default: True</span>
<span class="sd">    </span>
<span class="sd">        template_type - string specifying the type of HTML template to use.</span>
<span class="sd">                    Options from mpld3 are:</span>
<span class="sd">                    &quot;simple&quot; suitable for simple html page with one figure.</span>
<span class="sd">                    Will fail if require.js is available on the page.</span>
<span class="sd">                    &quot;notebook&quot; assumes require.js and jquery are available.</span>
<span class="sd">                    &quot;general&quot; works both in and out of the notebook,</span>
<span class="sd">                    whether or not require.js and jquery are available</span>
<span class="sd">                    Default: general</span>
<span class="sd">    </span>
<span class="sd">        **kw      - additional keyword arguments are passed to mpld3.save_html</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_legend</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span>
        <span class="n">fileobj</span><span class="o">=</span><span class="s1">&#39;{0}.html&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_spines_and_ticks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_title_and_labels</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_limits</span><span class="p">()</span>
    <span class="n">mpld3</span><span class="o">.</span><span class="n">save_html</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span>
                    <span class="n">fileobj</span><span class="o">=</span><span class="n">fileobj</span><span class="p">,</span>
                    <span class="n">template_type</span><span class="o">=</span><span class="n">template_type</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.save_pdf">
    <p>def <span class="ident">save_pdf</span>(</p><p>self, fileobj=None, legend=True, update=True, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Generate the figure as a pdf file</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>fileobj  -  a python file object
            Default: None (saved to a new file with the same
                           name as the parent object with .html)

legend   -  boolean for displaying a legend
            Default: True

update   -  boolean for reapplying spine, tick, title and 
            axis limits to the graph
            Default: True

**kw      - additional keyword arguments are passed to 
            matplotlib.PdfPages.savefig
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.save_pdf', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.save_pdf" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileobj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate the figure as a pdf file</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        fileobj  -  a python file object</span>
<span class="sd">                    Default: None (saved to a new file with the same</span>
<span class="sd">                                   name as the parent object with .html)</span>
<span class="sd">    </span>
<span class="sd">        legend   -  boolean for displaying a legend</span>
<span class="sd">                    Default: True</span>
<span class="sd">    </span>
<span class="sd">        update   -  boolean for reapplying spine, tick, title and </span>
<span class="sd">                    axis limits to the graph</span>
<span class="sd">                    Default: True</span>
<span class="sd">    </span>
<span class="sd">        **kw      - additional keyword arguments are passed to </span>
<span class="sd">                    matplotlib.PdfPages.savefig</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_legend</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_spines_and_ticks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_title_and_labels</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_limits</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fileobj</span><span class="p">:</span>
        <span class="n">fileobj</span><span class="o">=</span><span class="s1">&#39;{0}.html&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">matplotlib.backends.backend_pdf</span> <span class="kn">import</span> <span class="n">PdfPages</span>
    <span class="k">with</span> <span class="n">PdfPages</span><span class="p">(</span><span class="n">fileobj</span><span class="p">)</span> <span class="k">as</span> <span class="n">pdf</span><span class="p">:</span>
        <span class="n">pdf</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.set_limits">
    <p>def <span class="ident">set_limits</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Apply the axis limits set by self.xlim and self.ylim
to the graph axes.  The Kaplan-Meier y axis will remain
[0,1.02]</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.set_limits', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.set_limits" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Apply the axis limits set by self.xlim and self.ylim</span>
<span class="sd">    to the graph axes.  The Kaplan-Meier y axis will remain</span>
<span class="sd">    [0,1.02]&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">)</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylim</span> <span class="k">else</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.02</span><span class="p">])</span> <span class="c1">#set &gt;1 so lines retain full width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.02</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_autoscaley_on</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.set_spines_and_ticks">
    <p>def <span class="ident">set_spines_and_ticks</span>(</p><p>self, axes=None, remove_spines=[&#39;right&#39;, &#39;top&#39;], y_set_ticks=[&#39;left&#39;], x_set_ticks=[&#39;bottom&#39;])</p>
    </div>
    

    
  
    <div class="desc"><p>Set spines (the lines along the axis) and
tick locations for the plot</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>axes - the matplotlib.axis object to act on
       Default: None
       (interpreted as self.ax and self.km_ax)

remove_spines - a list of spines to remove.
       Default: [&#39;right&#39;,&#39;top&#39;]

y_set_ticks - a list of locations of y axis ticks
       Default: [&#39;left&#39;]

x_set_ticks - a list of locations of x axis ticks
       Default: [&#39;bottom&#39;]
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.set_spines_and_ticks', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.set_spines_and_ticks" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_spines_and_ticks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                        <span class="n">remove_spines</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="s1">&#39;top&#39;</span><span class="p">],</span>
                        <span class="n">y_set_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span>
                        <span class="n">x_set_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">],</span>
                        <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set spines (the lines along the axis) and</span>
<span class="sd">    tick locations for the plot</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">        </span>
<span class="sd">        axes - the matplotlib.axis object to act on</span>
<span class="sd">               Default: None</span>
<span class="sd">               (interpreted as self.ax and self.km_ax)</span>
<span class="sd">        </span>
<span class="sd">        remove_spines - a list of spines to remove.</span>
<span class="sd">               Default: [&#39;right&#39;,&#39;top&#39;]</span>
<span class="sd">        </span>
<span class="sd">        y_set_ticks - a list of locations of y axis ticks</span>
<span class="sd">               Default: [&#39;left&#39;]</span>
<span class="sd">        </span>
<span class="sd">        x_set_ticks - a list of locations of x axis ticks</span>
<span class="sd">               Default: [&#39;bottom&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axes</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">]</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">VolumeSurvivalPlot</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set_spines_and_ticks</span><span class="p">(</span><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">,</span>
                                                        <span class="n">remove_spines</span> <span class="o">=</span> <span class="n">remove_spines</span><span class="p">,</span>
                                                        <span class="n">y_set_ticks</span> <span class="o">=</span> <span class="n">y_set_ticks</span><span class="p">,</span>
                                                        <span class="n">x_set_ticks</span> <span class="o">=</span> <span class="n">x_set_ticks</span><span class="p">,)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">km_yticks</span><span class="p">)</span>
    
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.set_title_and_labels">
    <p>def <span class="ident">set_title_and_labels</span>(</p><p>self, title=None, ylabel=None, xlabel=None, km_title=None, km_ylabel=None, km_xlabel=None, hide_volume_labels=True, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Set plot titles and axis labels</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>title   -   main plot title
            Default: None (uses self.title)

ylabel  -   y axis label
            Default: None (uses self.ylabel)

xlabel  -   x axis label
            Default: None (uses self.xlabel)

kmtitle   - Kaplan Meier plot label
            Default: None (uses self.km_title)

ylabel  -   y axis label
            Default: None (uses self.km_ylabel)

xlabel  -   x axis label
            Default: None (uses self.km_xlabel)

hide_volume_labels - do not display x axis label
            between volume plot and Kaplan-Meier
            Default: True
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.set_title_and_labels', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.set_title_and_labels" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_title_and_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                         <span class="n">km_title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">km_ylabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">km_xlabel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                         <span class="n">hide_volume_labels</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set plot titles and axis labels</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        title   -   main plot title</span>
<span class="sd">                    Default: None (uses self.title)</span>
<span class="sd">    </span>
<span class="sd">        ylabel  -   y axis label</span>
<span class="sd">                    Default: None (uses self.ylabel)</span>
<span class="sd">    </span>
<span class="sd">        xlabel  -   x axis label</span>
<span class="sd">                    Default: None (uses self.xlabel)</span>
<span class="sd">    </span>
<span class="sd">        kmtitle   - Kaplan Meier plot label</span>
<span class="sd">                    Default: None (uses self.km_title)</span>
<span class="sd">    </span>
<span class="sd">        ylabel  -   y axis label</span>
<span class="sd">                    Default: None (uses self.km_ylabel)</span>
<span class="sd">    </span>
<span class="sd">        xlabel  -   x axis label</span>
<span class="sd">                    Default: None (uses self.km_xlabel)</span>
<span class="sd">    </span>
<span class="sd">        hide_volume_labels - do not display x axis label</span>
<span class="sd">                    between volume plot and Kaplan-Meier</span>
<span class="sd">                    Default: True</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
    <span class="k">if</span> <span class="n">ylabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span>
    <span class="k">if</span> <span class="n">xlabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span>
    <span class="k">if</span> <span class="n">km_title</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">km_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_title</span>
    <span class="k">if</span> <span class="n">km_ylabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">km_ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_ylabel</span>
    <span class="k">if</span> <span class="n">km_xlabel</span>  <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">km_xlabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">km_xlabel</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span> <span class="ow">and</span> <span class="ow">not</span> <span class="s1">&#39;fontsize&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
        <span class="n">kw</span><span class="p">[</span><span class="s1">&#39;fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontsize</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hide_volume_labels</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">km_title</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">km_ylabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">km_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">km_xlabel</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.shade_interval">
    <p>def <span class="ident">shade_interval</span>(</p><p>self, start, end, facecolor=&#39;lightgrey&#39;, alpha=0.2, lw=0, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Add rectangular fill the full height of the axis to indicate
a date range (eg for treatment).</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>start   -   the start point of the rectangle

end   -     the end point of the rectangle

facecolor - the fill color for the rectangular patches
            Valid colors include matplotlib named colors
            html colors (eg &#39;#029386&#39;) or RGB tuples
            (eg (0.0078, 0.58, 0.53))

alpha    -  Percent transparency as a value between
            0.0 (transparent) and 1.0 (opaque)
            Default: 0.2

lw     -   the width of the line bordering the patch in points
           Default: 0 (no line)

**kw  -   keyword arguments passed to matplotlib.patches.Rectangle
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.shade_interval', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.shade_interval" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">shade_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add rectangular fill the full height of the axis to indicate</span>
<span class="sd">    a date range (eg for treatment).</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        start   -   the start point of the rectangle</span>
<span class="sd">    </span>
<span class="sd">        end   -     the end point of the rectangle</span>
<span class="sd">    </span>
<span class="sd">        facecolor - the fill color for the rectangular patches</span>
<span class="sd">                    Valid colors include matplotlib named colors</span>
<span class="sd">                    html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                    (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">    </span>
<span class="sd">        alpha    -  Percent transparency as a value between</span>
<span class="sd">                    0.0 (transparent) and 1.0 (opaque)</span>
<span class="sd">                    Default: 0.2</span>
<span class="sd">    </span>
<span class="sd">        lw     -   the width of the line bordering the patch in points</span>
<span class="sd">                   Default: 0 (no line)</span>
<span class="sd">    </span>
<span class="sd">        **kw  -   keyword arguments passed to matplotlib.patches.Rectangle</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">miny</span><span class="p">,</span><span class="n">maxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">get_data_interval</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">start</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">miny</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">end</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">maxy</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                                                    <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">))</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="plot.VolumeSurvivalPlot.show_treatment_days">
    <p>def <span class="ident">show_treatment_days</span>(</p><p>self, days, facecolor=&#39;lightgrey&#39;, lw=0, **kw)</p>
    </div>
    

    
  
    <div class="desc"><p>Add rectangular patches on the x axis to indicate days
on which treatment occurred.</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span>days   -   an integer list of days eg [1,3,5]

facecolor - the fill color for the rectangular patches
            Valid colors include matplotlib named colors
            html colors (eg &#39;#029386&#39;) or RGB tuples
            (eg (0.0078, 0.58, 0.53))

lw     -   the width of the line bordering the patch in points
           Default: 0 (no line)

**kw  -   keyword arguments passed to matplotlib.patches.Rectangle
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-plot.VolumeSurvivalPlot.show_treatment_days', this);">Show source &equiv;</a></p>
  <div id="source-plot.VolumeSurvivalPlot.show_treatment_days" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">show_treatment_days</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add rectangular patches on the x axis to indicate days</span>
<span class="sd">    on which treatment occurred.</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    </span>
<span class="sd">        days   -   an integer list of days eg [1,3,5]</span>
<span class="sd">    </span>
<span class="sd">        facecolor - the fill color for the rectangular patches</span>
<span class="sd">                    Valid colors include matplotlib named colors</span>
<span class="sd">                    html colors (eg &#39;#029386&#39;) or RGB tuples</span>
<span class="sd">                    (eg (0.0078, 0.58, 0.53))</span>
<span class="sd">    </span>
<span class="sd">        lw     -   the width of the line bordering the patch in points</span>
<span class="sd">                   Default: 0 (no line)</span>
<span class="sd">    </span>
<span class="sd">        **kw  -   keyword arguments passed to matplotlib.patches.Rectangle</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">days</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">day</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">))</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.endpoint" class="name">var <span class="ident">endpoint</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.fontsize" class="name">var <span class="ident">fontsize</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.intervals" class="name">var <span class="ident">intervals</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.km_ci_show" class="name">var <span class="ident">km_ci_show</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.km_show_censors" class="name">var <span class="ident">km_show_censors</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.km_title" class="name">var <span class="ident">km_title</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.km_xlabel" class="name">var <span class="ident">km_xlabel</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.km_ylabel" class="name">var <span class="ident">km_ylabel</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.km_yticks" class="name">var <span class="ident">km_yticks</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.kmfs" class="name">var <span class="ident">kmfs</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.lines" class="name">var <span class="ident">lines</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#plot.TumourVolumePlot">TumourVolumePlot</a></code>.<code><a href="#plot.TumourVolumePlot.lines">lines</a></code>
    </p>

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.means" class="name">var <span class="ident">means</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.title" class="name">var <span class="ident">title</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.vertical" class="name">var <span class="ident">vertical</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.volume_data" class="name">var <span class="ident">volume_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.xlabel" class="name">var <span class="ident">xlabel</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.xlim" class="name">var <span class="ident">xlim</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.ylabel" class="name">var <span class="ident">ylabel</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="plot.VolumeSurvivalPlot.ylim" class="name">var <span class="ident">ylim</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
